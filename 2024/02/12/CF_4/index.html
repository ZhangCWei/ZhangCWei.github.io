<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.19.1","exturl":false,"sidebar":{"position":"left","Sidebar Display (only for Muse | Mist), available values":["hide    expand only when click on the sidebar toggle icon."],"display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="语法制导 语义分析的任务 1、在代码的声明语句中，会声明一些数据对象或过程并命名 -&gt; 标识符。语义分析就是收集标识符的属性信息，如&#x3D;&#x3D;种属、类型、存储位置和长度、值、作用域、参数和返回值信息&#x3D;&#x3D;，存于符号表中。 标识符往往存于字符串表中，故符号表的NAME字段存储其在字符串表中的起始位置与长度 2、语义分析的另一个任务，就是语义检查   未经声明就使用   重复声明   类型不匹配   …">
<meta property="og:type" content="article">
<meta property="og:title" content="Methods for DIP">
<meta property="og:url" content="http://example.com/2024/02/12/CF_4/index.html">
<meta property="og:site_name" content="Methods for DIP">
<meta property="og:description" content="语法制导 语义分析的任务 1、在代码的声明语句中，会声明一些数据对象或过程并命名 -&gt; 标识符。语义分析就是收集标识符的属性信息，如&#x3D;&#x3D;种属、类型、存储位置和长度、值、作用域、参数和返回值信息&#x3D;&#x3D;，存于符号表中。 标识符往往存于字符串表中，故符号表的NAME字段存储其在字符串表中的起始位置与长度 2、语义分析的另一个任务，就是语义检查   未经声明就使用   重复声明   类型不匹配   …">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231117224746499.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231017102547500.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231017102835811.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231017102852535.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231017103157631.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231017112244551.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231017110729555.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231117230329717.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231017113726177.png">
<meta property="og:image" content="d:%5CTypora_picture%5C4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC%5Cimage-20231017113819447.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231117231540253.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231019104235009.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231019103902527.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231019104500299.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231019105737510.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231019111902811.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231019112058886.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231019112228158.png">
<meta property="og:image" content="d:%5CTypora_picture%5C4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC%5Cimage-20231024090138324.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231024091123923.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231024090822728.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231024092046529.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231117234047489.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231024095836747.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231024100431054.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231117234813169.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231024101058586.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231024103016003.png">
<meta property="og:image" content="d:%5CTypora_picture%5C4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC%5Cimage-20231024104457331.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231024111120296.png">
<meta property="og:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231024112224668.png">
<meta property="og:image" content="d:%5CTypora_picture%5C4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC%5Cimage-20231024112419938.png">
<meta property="og:image" content="d:%5CTypora_picture%5C4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC%5Cimage-20231024112433106.png">
<meta property="article:published_time" content="2024-02-12T09:28:06.793Z">
<meta property="article:modified_time" content="2023-12-02T12:51:58.563Z">
<meta property="article:author" content="ZhangChengWei">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="d:\Typora_picture\4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC\image-20231117224746499.png">


<link rel="canonical" href="http://example.com/2024/02/12/CF_4/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2024/02/12/CF_4/","path":"2024/02/12/CF_4/","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title> | Methods for DIP</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Methods for DIP</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">By ZhangCW & WeiGP & JiangT</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-text">语法制导</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%AD%E4%B9%89%E5%88%86%E6%9E%90%E7%9A%84%E4%BB%BB%E5%8A%A1"><span class="nav-text">语义分析的任务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90%E4%B8%8E%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90%E5%90%8E%E5%BE%97%E5%88%B0%E7%9A%84%E4%BF%A1%E6%81%AF"><span class="nav-text">词法分析与语法分析后得到的信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC%EF%BC%9ASDD%E4%B8%8ESDT%E6%A6%82%E8%BF%B0"><span class="nav-text">语法制导：SDD与SDT概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BCSDD"><span class="nav-text">语法制导SDD</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#S%E5%B1%9E%E6%80%A7%E7%9A%84SDD"><span class="nav-text">S属性的SDD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SDD%E7%9A%84%E6%B1%82%E5%80%BC%E9%A1%BA%E5%BA%8F"><span class="nav-text">SDD的求值顺序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#L%E5%B1%9E%E6%80%A7%E7%9A%84SDD"><span class="nav-text">L属性的SDD</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B"><span class="nav-text">类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8A%BD%E8%B1%A1%E8%AF%AD%E6%B3%95%E6%A0%91%E7%9A%84%E6%9E%84%E9%80%A0"><span class="nav-text">抽象语法树的构造</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC%E7%BF%BB%E8%AF%91%E6%96%B9%E6%A1%88SDT"><span class="nav-text">语法制导翻译方案SDT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0L%E5%B1%9E%E6%80%A7%E7%9A%84SDD"><span class="nav-text">实现L属性的SDD</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text">总结</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ZhangChengWei</p>
  <div class="site-description" itemprop="description">paper analysis</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/02/12/CF_4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ZhangChengWei">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Methods for DIP">
      <meta itemprop="description" content="paper analysis">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Methods for DIP">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-02-12 17:28:06" itemprop="dateCreated datePublished" datetime="2024-02-12T17:28:06+08:00">2024-02-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-12-02 20:51:58" itemprop="dateModified" datetime="2023-12-02T20:51:58+08:00">2023-12-02</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1>语法制导</h1>
<h2 id="语义分析的任务">语义分析的任务</h2>
<p>1、在代码的声明语句中，会声明一些数据对象或过程并命名 -&gt; 标识符。语义分析就是<strong>收集标识符的属性信息</strong>，如==种属、类型、存储位置和长度、值、作用域、参数和返回值信息==，存于<strong>符号表</strong>中。</p>
<p>标识符往往存于字符串表中，故符号表的NAME字段存储其在字符串表中的起始位置与长度</p>
<p>2、语义分析的另一个任务，就是语义检查</p>
<ul>
<li>
<p>未经声明就使用</p>
</li>
<li>
<p>重复声明</p>
</li>
<li>
<p>类型不匹配</p>
</li>
<li>
<p>…</p>
</li>
</ul>
<h2 id="词法分析与语法分析后得到的信息">词法分析与语法分析后得到的信息</h2>
<p>输入程序通过了词法分析</p>
<ul>
<li>
<p>输入程序符合词法规则</p>
</li>
<li>
<p>过滤了注释、空白字符等无用信息</p>
</li>
<li>
<p>得到合法的符号流（合法的变量名、关键字…）</p>
</li>
</ul>
<p>输入程序通过了语法分析</p>
<ul>
<li>
<p>输入程序符合语法规则</p>
</li>
<li>
<p>得到合法的语法分析树</p>
</li>
</ul>
<p>语法分析技术不能检查语义</p>
<ul>
<li>
<p>语义分析往往与语法元素的上下文密切相关</p>
</li>
<li>
<p>完全相同的语句在不同上下文中可具有不同语义</p>
</li>
</ul>
<h2 id="语法制导：SDD与SDT概述">语法制导：SDD与SDT概述</h2>
<p><strong>语法制导的两个阶段</strong></p>
<ul>
<li>
<p>语法分析</p>
</li>
<li>
<p>语义翻译(语义分析、中间代码生成)</p>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231117224746499.png" alt="image-20231117224746499" style="zoom:50%;" />
<p>语法制导翻译使用<strong>上下文无关文法</strong>(CFG)来引导对语言的翻译，是一种面向文法的翻译技术</p>
<p><strong>语法制导翻译的基本思想</strong></p>
<ul>
<li>
<p>如何表示语义信息</p>
<ul>
<li>为CFG中的文法符号设置语义属性，用来表示语法成分对应的语义信息</li>
</ul>
</li>
<li>
<p>如何计算语义属性</p>
<ul>
<li>
<p>文法符号的语义属性值是与文法符号所在产生式(语法规则)相关联的语义规则来计算的</p>
</li>
<li>
<p>对于给定的输入串x，构建x的语法分析树，并利用与产生式(语法规则)相关联的语义规则来计算分析树中各结点对应的语义属性值</p>
</li>
</ul>
</li>
</ul>
<p><strong>SDD与SDT概述</strong></p>
<ul>
<li>
<p>语法制导定义（Syntax-directed definitions，SDD）</p>
<ul>
<li>简单来说，如果 X 是一个文法符号， a 是 X 的属性，则用 X.a 来表示属性 a 在分析树上的标号为 X 的节点的值，这样的文法就称为SDD</li>
</ul>
</li>
<li>
<p>语法制导翻译方案（Syntax-directed Translation Scheme，SDT）</p>
<ul>
<li>在产生式体中嵌入了<strong>称为语义动作的程序片段</strong>的CFG，对文法符号的属性值进行计算</li>
</ul>
</li>
<li>
<p>关系与区别</p>
<ul>
<li>SDD是关于语言翻译的高层次规格说明，隐藏了许多实现细节；</li>
<li>SDT可以看做是对SDD的一个补充，它显式地指明了<strong>语义规则的计算顺序</strong>，以便说明某些实现细节</li>
</ul>
</li>
</ul>
<p><strong>语法制导定义SDD</strong>(Syntax-Directed Definition)</p>
<ul>
<li>
<p>SDD是对CFG的推广</p>
<ul>
<li>
<p>将每个文法符号和一个语义属性集合相关联</p>
</li>
<li>
<p>将每个产生式和一组语义规则相关联，这些规则用于计算该产生式中各文法符号的属性值</p>
</li>
</ul>
</li>
<li>
<p>若X是一个文法符号，a是X的一个属性，则用X.a表示属性a在某个标号为X的分析树结点上的值</p>
</li>
</ul>
<p><strong>语法制导翻译方案SDT</strong></p>
<ul>
<li>
<p>SDT是在产生式右部嵌入了程序片段的CFG，这些程序片段称为语义动作，放在{}内</p>
</li>
<li>
<p>SDD的具体实施方案</p>
</li>
</ul>
<h2 id="语法制导SDD">语法制导SDD</h2>
<p><strong>SDD是 上下文无关文法 和 ==属性/规则== 的结合</strong></p>
<ul>
<li>
<p><strong>属性</strong>和<strong>文法符号</strong>相关联，按照需要来确定各个文法符号需要哪些属性</p>
</li>
<li>
<p><strong>规则</strong>和<strong>产生式</strong>相关联</p>
</li>
<li>
<p>SDD<strong>三要素</strong>：==文法、属性、规则==</p>
</li>
<li>
<p>属性可视为语义的具象化表示： 类型、 值、 名字、 地址……</p>
</li>
</ul>
<p><strong>对于文法符号X和属性a，我们用X.a表示分析树中某个标号为X的结点的值</strong></p>
<ul>
<li>
<p>一个分析树结点和它的分支对应一个产生式规则</p>
</li>
<li>
<p>对应的语义规则确定这些结点属性的<strong>取值和计算</strong></p>
</li>
<li>
<p>基于SDD， 我们可以在一个程序的分析树上进行语义信息的计算</p>
</li>
</ul>
<p><strong>示例1</strong>：</p>
<ul>
<li>产生式规则1：E → E1 + T<br>
<code>E.type = if (E1.type == T.type) T.type else float;</code></li>
<li>产生式规则2： F → id<br>
<code>F.type = lookupIDTable(id.name)-&gt;type;</code></li>
<li>产生式规则3： E → T<br>
<code>E.type = T.type;</code></li>
<li>产生式规则4： T → F<br>
<code>T.type = F.type;</code></li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231017102547500.png" alt="image-20231017102547500" style="zoom:50%;" />
<p>==<strong>综合属性</strong>==</p>
<ul>
<li>自底向上</li>
<li>节点N的属性值由<strong>N的产生式</strong>所关联的语义规则来定义</li>
<li>通过N的<strong>子节点</strong>或<strong>N本身</strong>的属性值来定义</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231017102835811.png" alt="image-20231017102835811" style="zoom: 50%;" />
<p>==<strong>继承属性</strong>==</p>
<ul>
<li>
<p>自顶向下</p>
</li>
<li>
<p>结点N的属性值由<strong>N的父节点</strong>所关联的语义规则来定义</p>
</li>
<li>
<p>依赖于<strong>N的父节点</strong>、<strong>N本身</strong>和<strong>N的兄弟节点</strong>上的属性值</p>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231017102852535.png" alt="image-20231017102852535" style="zoom:50%;" />
<h3 id="S属性的SDD">S属性的SDD</h3>
<ul>
<li>
<p>只包含<strong>综合属性</strong>的SDD称为<strong>S属性的SDD</strong></p>
<ul>
<li>每个语义规则都根据<strong>产生式体中的属性值</strong>来计算头部非终结符号的属性值</li>
</ul>
</li>
<li>
<p>S属性的SDD可以和LR语法分析器一起实现</p>
<ul>
<li>
<p>栈中的状态/文法符号可以<strong>附加相应的属性值</strong></p>
</li>
<li>
<p><strong>归约时</strong>，按照语义规则<strong>计算</strong>归约得到的符号的属性值</p>
</li>
</ul>
</li>
<li>
<p>语义规则一般不应该有复杂的副作用</p>
<ul>
<li>副作用不影响其它属性的求值</li>
<li>没有副作用的SDD称为属性文法</li>
<li>这样就便于语义信息的计算，每次可专注于当前的产生式</li>
</ul>
</li>
</ul>
<p><strong>示例2</strong>：</p>
<p>​	终结符号digit有综合属性lexval</p>
<p>​	产生式与语义规则如下：</p>
<img src="D:\Typora_picture\4_语法制导\image-20231017103157631.png" alt="image-20231017103157631" style="zoom:50%;" />
<ul>
<li>
<p>在依赖图中，总是通过<strong>子结点的属性值</strong>来计算<strong>父结点的属性值</strong>，可以与自底向上或自顶向下的<strong>语法分析过程</strong>一起计算</p>
<ul>
<li>自底向上：在构造分析树结点的同时计算相关的属性</li>
<li>自顶向下：在递归子程序法中，在过程A()的最后计算A的属性</li>
</ul>
</li>
<li>
<p>在分析树上计算SDD：</p>
<ul>
<li>按照<strong>后序遍历</strong>的顺序计算属性值即可</li>
</ul>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">postorder(N)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span> (从左边开始，对N的每个子结点C)</span><br><span class="line">		postorder(C);</span><br><span class="line">	<span class="comment">// 递归调用返回时，各子结点的属性已计算完毕</span></span><br><span class="line">	对N的各个属性求值; <span class="comment">// N.a = … Ci.ai …</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>S属性SDD的局限
<ul>
<li>S属性的SDD中每个属性都是综合属性</li>
<li>无法计算<strong>同时</strong>需要继承和综合属性的语义信息。如下例：
<ul>
<li><strong>id</strong>类型的确定需要<strong>兄弟节点</strong>先确定</li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231017112244551.png" alt="image-20231017112244551" style="zoom:50%;" />
<h3 id="SDD的求值顺序">SDD的求值顺序</h3>
<ul>
<li>
<p><strong>注释语法分析树</strong></p>
<ul>
<li>
<p>包含了各个结点的各属性值的语法分析树</p>
</li>
<li>
<p>步骤：</p>
<ul>
<li>对于任意的输入串，首先构造出相应的<strong>分析树</strong></li>
<li>给各个结点 (根据其文法符号) <strong>加上相应的属性</strong></li>
<li>按照语义规则<strong>计算</strong>这些属性的值</li>
</ul>
</li>
<li>
<p>计算顺序</p>
<ul>
<li>
<p>如果某个结点N的属性a为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>N</mi><mn>1</mn></msub><mi mathvariant="normal">.</mi><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>N</mi><mi>k</mi></msub><mi mathvariant="normal">.</mi><msub><mi>b</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(N_1.b_1,…,N_k.b_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>， 那么我们需要先算出<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mn>1</mn></msub><mi mathvariant="normal">.</mi><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>N</mi><mi>k</mi></msub><mi mathvariant="normal">.</mi><msub><mi>b</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">N_1.b_1,…, N_k.b_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的值</p>
</li>
<li>
<p>S属性的SDD一定可以按照<strong>自底向上</strong>的方式求值</p>
</li>
<li>
<p><strong>循环依赖</strong>的SDD不可以计算</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>注释分析树示例：</p>
<ul>
<li>对于综合属性，因为依赖于子节点，所以很自然地，可以按照<strong>自下向上</strong>的文法分析方法获得val属性。在下面的注释语法分析树中我们可以看到，每个节点都关联了一个值。分析各个节点的属性的计算可以自下而上地完成。</li>
</ul>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231017110729555.png" alt="image-20231017110729555" style="zoom:40%;" />
<img src="D:\Typora_picture\4_语法制导\image-20231117230329717.png" alt="image-20231117230329717" style="zoom:50%;" />
<ul>
<li>和<strong>终结符号</strong>的综合属性<strong>直接由词法分析器给出</strong>不同，<strong>非终结符号</strong>的综合属性和继承属性都或多或少地<strong>依赖于其他属性</strong>，因此确定一棵注释语法分析树中属性的求值顺序是十分重要的，我们可以使用<strong>依赖图</strong>来表示计算顺序
<ul>
<li>依赖图：描述了某棵特定的分析树上各个属性之间的<strong>信息流</strong>（计算顺序）
<ul>
<li>属性结点：对于每个结点 N，<strong>N 的每个属性</strong>在依赖图中都有一个<strong>结点</strong></li>
<li>综合属性的边：如果和产生式 p 关联的语义规则通过 X.a 的值定义了综合属性 Y.b 的值，那么在依赖图中有一条从 X.a 到 Y.b 的边；</li>
<li>继承属性的边：如果和产生式 p 关联的语义规则通过 X.a 的值定义了继承属性 Y.b 的值，那么在依赖图中有一条从 X.a 到 Y.b 的边</li>
</ul>
</li>
<li>值的计算顺序形成<strong>偏序关系</strong>，如果依赖图中出现<strong>环</strong>，表示属性值无法计算</li>
<li>各个属性值需要按照依赖图的<strong>拓扑顺序</strong>计算</li>
</ul>
</li>
</ul>
<h3 id="L属性的SDD">L属性的SDD</h3>
<ul>
<li>
<p>在一个产生式所关联的各属性之间，依赖图的边可以从左到右，但不能从右到左</p>
</li>
<li>
<p>==<strong>L-SDD的正式定义</strong>==：</p>
<ul>
<li>
<p>一个SDD是L-属性定义，当且仅当它的<strong>每个属性</strong>满足以下<strong>一个</strong>条件:</p>
<ul>
<li>
<p>是<strong>综合属性</strong>；</p>
</li>
<li>
<p>满足以下条件的<strong>继承属性</strong>：</p>
<ul>
<li>假设存在一个产生式<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>−</mo><mo>&gt;</mo><msub><mi>X</mi><mn>1</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>X</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A-&gt;X_1X_2...X_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">...</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，其右部符号<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的继承属性仅依赖于以下属性：
<ul>
<li>
<p><strong>A <strong>的</strong>继承属性</strong>(而不是综合属性)；</p>
</li>
<li>
<p>X~i~ <strong>左边</strong>符号的属性；</p>
</li>
<li>
<p>X~i~ <strong>本身</strong>的属性（但Xi的全部属性不能成环）</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>从语法分析树的角度看，当这些规则被应用于某个结点时，使用的信息“来自于<strong>上边或左边</strong>”的语法树结点。</p>
</li>
</ul>
</li>
<li>
<p>特点</p>
<ul>
<li>依赖图中的边：综合属性<strong>从下到上</strong>、继承属性<strong>从上到下</strong>或<strong>从左到右</strong></li>
<li>计算一个属性值时，它所依赖的属性值都已计算完毕</li>
<li>每个S-SDD都是L-SDD</li>
</ul>
</li>
<li>
<p><strong>L属性SDD和自顶向下语法分析</strong></p>
<ul>
<li>
<p>在递归子程序法中实现L属性</p>
</li>
<li>
<p>对于每个<strong>非终结符号A</strong>，调用其对应过程前<strong>计算继承属性</strong>，从<strong>过程返回前</strong>计算综合属性</p>
</li>
<li>
<p>在处理规则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>−</mo><mo>&gt;</mo><msub><mi>X</mi><mn>1</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>X</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A-&gt;X_1X_2...X_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">...</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>时：</p>
<ul>
<li>在调用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>()<strong>之前</strong>计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的<strong>继承属性</strong></li>
<li>在该产生式对应代码的<strong>最后计算A的综合属性</strong></li>
<li>如果所有文法符号的属性计算按上面的方式进行，计算顺序必然和依赖关系一致</li>
</ul>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">L_dfvisit(n)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span> m = 从左到右n的每个子节点 <span class="keyword">do</span></span><br><span class="line">	&#123;</span><br><span class="line">		计算m的继承属性;</span><br><span class="line">		L_dfvisit(m);</span><br><span class="line">	&#125;</span><br><span class="line">	计算n的综合属性;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231017113726177.png" alt="image-20231017113726177" style="zoom:100%;" />
<p><strong>示例1</strong></p>
<p>​		判断下面规则是否是L属性的SDD？</p>
<p><img src="D:%5CTypora_picture%5C4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC%5Cimage-20231017113819447.png" alt=""></p>
<p>​		答：不是，<em>B</em>属性的计算过程依赖于<em>C</em>，但<em>C</em>在<em>B</em>的右边。</p>
<p><strong>示例2</strong></p>
<ul>
<li>
<p>下面的文法是变量声明</p>
<ul>
<li>
<p>产生式2和3的语义规则中， T 的属性是子节点定义的，是综合属性</p>
</li>
<li>
<p>产生式1和4中，D 和 L 分别获得了兄弟节点和父节点的属性，所以是继承属性。</p>
<p>这里的L.inh表示的就是<strong>它生成的变量的类型</strong></p>
</li>
<li>
<p>addtype是一个<strong>副作用</strong>，可在<strong>符号表</strong>中将对应位置给相应变量，添加上它的属性值</p>
</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">产生式</th>
<th style="text-align:center">语义规则</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">D -&gt; T L</td>
<td style="text-align:center">L.inh =T.type</td>
</tr>
<tr>
<td style="text-align:center">T -&gt; <strong>int</strong></td>
<td style="text-align:center">T.type = int</td>
</tr>
<tr>
<td style="text-align:center">T -&gt; <strong>real</strong></td>
<td style="text-align:center">T.type = real</td>
</tr>
<tr>
<td style="text-align:center">L -&gt; L1, <strong>id</strong></td>
<td style="text-align:center">L1.inh = L.inh  <br /><em>addtype</em>(<strong>id</strong>.<em>lexeme</em>, L.inh)</td>
</tr>
<tr>
<td style="text-align:center">L -&gt; <strong>id</strong></td>
<td style="text-align:center"><em>addtype</em>(<strong>id</strong>.<em>lexeme</em>, L.inh)</td>
</tr>
</tbody>
</table>
<ul>
<li>那么，在接收 real a, b, c 时，注释分析树是这样的：
<ul>
<li>lexeme由词法分析器提供，也即是文法节点自身的属性</li>
<li>对于继承属性，因为依赖父节点，故自然地按<strong>自上向下</strong>的文法分析方法获得.inh属性</li>
<li>每个节点都关联了一个值，分析各个节点的属性的计算可以自上而下地完成。</li>
</ul>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231117231540253.png" alt="image-20231117231540253" style="zoom: 50%;" />
<p><strong>例题</strong></p>
<ul>
<li>一、使用 S 的综合属性 val 给出下面文法 S 产生的二进制的值。例如，输入101.101时，S.val = 5.625。要求<strong>仅用综合属性</strong>来计算S.val</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">答案：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>二、为文法</li>
</ul>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">S -&gt; (L) | a</span><br><span class="line">L -&gt; L,S | S</span><br></pre></td></tr></table></figure>
<p>(a) 写一个语法制导定义，它输出括号的对数。</p>
<p>(b) 写一个文法制导定义，它输出括号嵌套的最大深度。</p>
<p>© 写一个翻译方案，输出每个a的嵌套深度。如，对于句子（a,(a,a)），输出的结果是1 2 2.</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="类型">类型</h2>
<ul>
<li><strong>类型的定义</strong>：不同语言有不同的定义</li>
<li><strong>非严谨的概况</strong>：==类型 ≈ 数据 +操作==
<ul>
<li>数据：一个类型包含的所有<strong>取值</strong>集合</li>
<li>操作：一个类型支持的所有<strong>操作</strong>集合</li>
</ul>
</li>
<li><strong>类型检查</strong>
<ul>
<li>计算各<strong>表达式的类型</strong></li>
<li>检查各个运算是否是相关类型所<strong>支持</strong>的合法操作</li>
</ul>
</li>
<li><strong>基本类型的变量声明</strong></li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">产生式</th>
<th style="text-align:center">语义规则</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">D -&gt; T L</td>
<td style="text-align:center">L.inh =T.type</td>
</tr>
<tr>
<td style="text-align:center">T -&gt; <strong>int</strong></td>
<td style="text-align:center">T.type = int</td>
</tr>
<tr>
<td style="text-align:center">T -&gt; <strong>float</strong></td>
<td style="text-align:center">T.type = float</td>
</tr>
<tr>
<td style="text-align:center">L -&gt; L1, <strong>id</strong></td>
<td style="text-align:center">L1.inh = L.inh   <strong>id</strong>.type = L.inh</td>
</tr>
<tr>
<td style="text-align:center">L -&gt; <strong>id</strong></td>
<td style="text-align:center"><strong>id</strong>.type =L.inh</td>
</tr>
</tbody>
</table>
<p>​		注：L是跟在T后面的整个串</p>
<p>​				inh是定义的一种继承属性(L.inh =T.type就是<strong>从左兄弟处获得属性</strong>)</p>
<img src="D:\Typora_picture\4_语法制导\image-20231019104235009.png" alt="image-20231019104235009" style="zoom:50%;" />
<ul>
<li>具有<strong>受控副作用</strong>的语义规则(了解)
<ul>
<li>属性文法没有副作用，但增加了描述的复杂度
<ul>
<li>比如语法分析时，如果没有副作用，标识符表就必须作为属性传递</li>
<li>可以把标识符表作为全局变量，然后通过函数来添加新的标识符</li>
</ul>
</li>
<li>受控的副作用
<ul>
<li>不会对属性求值产生约束，即可以按照任何拓扑顺序求值，不会影响最终结果</li>
<li>或者对求值过程添加简单的约束</li>
</ul>
</li>
<li>示例：通过<strong>查表</strong>(需要额外空间)获取属性</li>
</ul>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231019103902527.png" alt="image-20231019103902527" style="zoom:50%;" />
<ul>
<li><strong>计算形如int [2][3]的类型</strong>
<ul>
<li>类型包括两个部分：T -&gt; B C
<ul>
<li>基本类型 B</li>
<li>分量 C</li>
</ul>
</li>
<li>数组构造算符array(n, t)
<ul>
<li>array(2, array(3, int))表示抽象的2×3的二维数组</li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231019104500299.png" alt="image-20231019104500299" style="zoom:50%;" />
<p>​		下图的计算顺序为：</p>
<p>​		<em>B.t=integer</em>   -&gt;   <em>C.b=B.t</em>   -&gt;   <em>C.t=C.b</em>   -&gt;   ……</p>
<img src="D:\Typora_picture\4_语法制导\image-20231019105737510.png" alt="image-20231019105737510" style="zoom:50%;" />
<h2 id="抽象语法树的构造">抽象语法树的构造</h2>
<ul>
<li>具体语法树(CST)
<ul>
<li>保留<strong>所有</strong>词法元素，包含对分析无用的噪音</li>
<li>所有词法元素都有<strong>对应</strong>节点，节点数量大</li>
<li><strong>完整</strong>地还原非终结符到串的推导过程，包含所有中间推导过程，引入大量中间节点</li>
<li>严格符合源语言的<strong>上下文无关</strong>文法，可根据文法自动生成</li>
</ul>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231019111902811.png" alt="image-20231019111902811" style="zoom:50%;" />
<ul>
<li>抽象语法树(AST)
<ul>
<li><strong>只保留必要的</strong>词法元素</li>
<li><strong>某些</strong>词法元素信息<strong>存入父节点的属性</strong></li>
<li>移除没有实质信息的中间推导过程</li>
<li><strong>不符合</strong>源语言的上下文无关文法</li>
<li>优点
<ul>
<li>更少的结点数量与种类</li>
<li>更易于分析和处理</li>
<li>独⽴于具体⽂法</li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231019112058886.png" alt="image-20231019112058886" style="zoom:50%;" />
<ul>
<li>构造简单表达式的抽象语法树的SDD
<ul>
<li>属性<em>E.node</em>指向E对应的抽象语法树的<strong>根结点</strong></li>
</ul>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231019112228158.png" alt="image-20231019112228158" style="zoom:50%;" />
<ul>
<li>输入：<strong>a-4+c</strong></li>
<li>步骤：
<ul>
<li>p1 =new Leaf(id, entry_a);</li>
<li>p2 =new Leaf(num, 4);</li>
<li>p3 =new Node(‘–’, p1, p2);</li>
<li>p4 =new Leaf(id, entry_c);</li>
<li>p5 =new Node(‘+’, p3, p4);</li>
</ul>
</li>
</ul>
<p><img src="D:%5CTypora_picture%5C4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC%5Cimage-20231024090138324.png" alt="image-20231024090138324"></p>
<h2 id="语法制导翻译方案SDT">语法制导翻译方案SDT</h2>
<p><strong>SDT定义</strong></p>
<ul>
<li>
<p>SDT是在<strong>产生式右部</strong>中嵌入了<strong>程序片段</strong>(语义动作)的CFG</p>
</li>
<li>
<p>SDT可以看作是SDD的具体实施方案</p>
</li>
</ul>
<p><strong>SDT的基本实现方法</strong></p>
<ul>
<li>
<p>建立<strong>抽象语法分析树</strong></p>
</li>
<li>
<p>将语义动作看作是<strong>虚拟结点</strong>(绑定语义动作)</p>
</li>
<li>
<p><strong>深度优先、从左到右</strong>遍历分析树，在访问虚拟结点时执行相应的语义动作</p>
</li>
<li>
<p><strong>示例</strong></p>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231024091123923.png" alt="image-20231024091123923" style="zoom:33%;" />
<p>​		语句3*4*5的分析树如下：</p>
<p>​		动作执行顺序为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><msub><mn>7</mn><mn>1</mn></msub><mo separator="true">,</mo><mi>A</mi><mn>5</mn><mo separator="true">,</mo><mi>A</mi><msub><mn>7</mn><mn>2</mn></msub><mo separator="true">,</mo><mi>A</mi><msub><mn>4</mn><mn>1</mn></msub><mo separator="true">,</mo><mi>A</mi><msub><mn>7</mn><mn>3</mn></msub><mo separator="true">,</mo><mi>A</mi><msub><mn>4</mn><mn>2</mn></msub><mo separator="true">,</mo><mi>A</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">A7_1,A5,A7_2,A4_1,A7_3,A4_2,A3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord">7</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord">7</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord">7</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mord">3</span></span></span></span></p>
<img src="D:\Typora_picture\4_语法制导\image-20231024090822728.png" alt="image-20231024090822728" style="zoom: 67%;" />
<p><strong>可在语法分析过程中实现的SDT</strong></p>
<ul>
<li>
<p>实现SDT时，实际上并不会真的构造语法分析树，而是在分析过程中执行语义动作</p>
</li>
<li>
<p>即使基础文法可以应用某种语法分析技术，仍可能因为动作的缘故导致此技术不可应用</p>
</li>
<li>
<p>判断是否可在分析过程中实现：</p>
<ul>
<li>将每个语义动作替换为一个独有的非终结符号<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">M_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，其产生式为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>i</mi></msub><mo>→</mo><mi>ε</mi></mrow><annotation encoding="application/x-tex">M_i → ε</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ε</span></span></span></span></li>
<li>如果新的文法可以由某种方法进行分析，那么这个SDT就可以在这个分析过程中实现</li>
</ul>
</li>
<li>
<p><strong>示例</strong></p>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231024092046529.png" alt="image-20231024092046529" style="zoom:50%;" />
<p>==<strong>用SDT实现两类重要的SDD</strong>==</p>
<ul>
<li>
<p>基本文法可使用LR分析技术，且SDD是S属性的</p>
<ul>
<li>
<p>SDT可在LR语法分析过程中实现</p>
</li>
<li>
<p>在归纳 (<strong>产生式右侧的符号全部计算完毕后</strong>) 发生时执行<strong>相应的语义动作</strong><br>
也就是说，全部放在<strong>产生式右部的最右边</strong>就行（后缀SDT）</p>
</li>
<li>
<p>在分析栈中使用一个附加的域来存放综合属性值</p>
</li>
</ul>
</li>
<li>
<p>基本文法可使用LL分析技术，且SDD是L属性的</p>
<ul>
<li>将计算某个<strong>非终结符号A</strong>的<strong>继承属性</strong>的<strong>动作</strong>插入到产生式右部**紧靠在A的<u>本次出现之前</u>**的位置</li>
<li>将计算一个产生式<strong>左部符号的综合属性</strong>放置在这个产生式<strong>右部的最右端</strong></li>
</ul>
</li>
<li>
<p>示例：L-SDD转换为SDT（这个是一个LL文法）</p>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231117234047489.png" alt="image-20231117234047489" style="zoom:50%;" />
<p><strong>如果一个L-SDD基本文法可使用LL分析技术，那么它的SDT可在LL/LR语法分析过程中实现:</strong></p>
<ul>
<li>
<p>在非递归的预测分析过程中进行语义翻译</p>
</li>
<li>
<p>在递归的预测分析过程中进行语义翻译</p>
</li>
<li>
<p>在LR分析过程中进行语义翻译</p>
</li>
</ul>
<p><strong>后缀翻译方案</strong></p>
<ul>
<li>
<p>文法可以自底向上分析 (即LR的) 且其SDD是S属性的，必然可以构造出后缀SDT</p>
</li>
<li>
<p><strong>后缀SDT</strong>：所有动作都在<strong>产生式最右端</strong>的SDT</p>
</li>
<li>
<p>构造方法</p>
<ul>
<li>将每个<strong>语义规则</strong>看作是一个<strong>赋值语义动作</strong></li>
<li>将所有的<strong>语义动作</strong>放在规则的<strong>最右端</strong></li>
</ul>
</li>
<li>
<p>实现桌上计算器的后缀SDT</p>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231024095836747.png" alt="image-20231024095836747" style="zoom:50%;" />
<ul>
<li>注意动作中对属性值的引用
<ul>
<li>允许语句引用<strong>全局变量</strong>、<strong>局部变量</strong>和<strong>文法符号的属性</strong></li>
<li>文法符号的属性只能被<strong>赋值一次</strong></li>
</ul>
</li>
<li><strong>后缀SDT的语法分析栈实现</strong>
<ul>
<li><u>归约时执行</u>相应的语义动作</li>
<li>属性和文法符号(或状态)<u>一起放在栈中</u>的记录里</li>
<li>在按照产生式 A-&gt;XYZ 归约时，Z的属性可以在栈顶找到，Y的属性可以在下一个位置找到，X的属性可以在下下个位置找到</li>
<li>这样，就可以进一步地，将语义动作中的抽象定义改写成<strong>具体可执行的栈操作</strong></li>
</ul>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231024100431054.png" alt="image-20231024100431054" style="zoom:50%;" />
<img src="D:\Typora_picture\4_语法制导\image-20231117234813169.png" alt="image-20231117234813169" style="zoom: 25%;" />
<ul>
<li>分析栈实现的实例
<ul>
<li>假设语法分析栈存放在一个被称为stack的记录数组中，下标top指向栈顶
<ul>
<li>stack[top]指向这个栈的栈顶</li>
<li>stack[top – 1]指向栈顶下一个位置</li>
</ul>
</li>
<li>如果不同的文法符号有<strong>不同的属性集合</strong>，我们可以使用union来保存这些属性值
<ul>
<li>归约时能够知道<strong>栈顶向下的各个符号</strong>分别是什么，因此我们也能够确定各个union中存放了什么值</li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231024101058586.png" alt="image-20231024101058586" style="zoom:50%;" />
<p><strong>产生式内部带有语义动作的SDT</strong></p>
<ul>
<li>
<p><strong>动作左边</strong>的所有符号 (以及动作) 处理完成后，就立刻执行这个动作：B -&gt; X {a} Y</p>
<ul>
<li>自底向上分析时，在<strong>X出现在栈顶</strong>时执行动作a</li>
<li>自顶向下分析时，在<strong>试图展开Y</strong>(式)或者<strong>在输入中检测到Y</strong>(符号)的时刻执行a</li>
</ul>
</li>
<li>
<p>对一般的SDT，都可以先建立分析树 (语义动作作为虚拟结点)，然后进行<strong>前序遍历</strong>并执行动作</p>
</li>
<li>
<p>不是所有的SDT都可以在分析过程中实现</p>
<ul>
<li>后缀SDT以及L属性对应的SDT可以在分析时完成</li>
</ul>
</li>
</ul>
<p><strong>L属性的SDT</strong></p>
<ul>
<li>除了通用的SDT实现技术，若基础文法是<strong>LL</strong>的，则可以将<strong>L属性SDD转换成一个SDT</strong>，该SDT可以在自顶向下的分析过程中实现</li>
<li>从L属性的SDD到SDT的转换
<ul>
<li>将每个语义规则看作是一个赋值语义动作</li>
<li>将赋值语义动作放到相应产生式A -&gt; X~1~ X~2~ … X~n~的适当位置
<ul>
<li>计算<strong>X~i~继承属性</strong>的<strong>动作</strong>插入到产生式体中<strong>X~i~的左边</strong></li>
<li>计算<strong>产生式头A综合属性的动作</strong>在产生式的<strong>最右边</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>while语句的SDD和SDT</strong></p>
<ul>
<li>
<p>产生式<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>−</mo><mo>&gt;</mo><mi>w</mi><mi>h</mi><mi>i</mi><mi>l</mi><mi>e</mi><mo stretchy="false">(</mo><mi>C</mi><mo stretchy="false">)</mo><msub><mi>S</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">S-&gt;while(C)S_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">−</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">hi</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>为while语句生成中间代码</li>
<li>主要说明语句控制流中的<strong>标号生成</strong></li>
</ul>
</li>
<li>
<p>while语句的含义</p>
<ul>
<li>首先对C求值，若为真，则控制转向S~1~的开始处</li>
<li>若为假，则转向while语句的后续语句开始处</li>
<li>S~1~结束时，要能够跳转到while语句的代码开始处</li>
</ul>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231024103016003.png" alt="image-20231024103016003" style="zoom:50%;" />
<ul>
<li>
<p><em>code</em>是综合属性，<em>true</em>、<em>false</em>和<em>next</em>是继承属性</p>
</li>
<li>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">S_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是函数体，需要一个<em>next</em>属性跳出或返回循环</p>
</li>
<li>
<p>语义动作</p>
<ul>
<li>
<p><strong>(a)</strong>  L1 = new( )和L2 = new( )：生成新标号 (L1用于判断，L2是循环体)</p>
</li>
<li>
<p><strong>(b)</strong>  C.false = S.next; C.true = L2：</p>
<p>​       计算C的继承属性 (当true或false时，分别需要跳转的地方)</p>
</li>
<li>
<p><strong>©</strong>  S1.next = L1：计算S1的继承属性 (S1是函数体，结束后回到L1进行判断)</p>
</li>
<li>
<p><strong>(d)</strong>  S.code = …：计算S的综合属型 (S与S1是一样的，加标号是为了便于区分)</p>
</li>
</ul>
</li>
<li>
<p>根据放置语义动作的规则得到SDT：</p>
<p>**(b)<strong>在C之前，</strong>©<strong>在S1之前，</strong>(d)<strong>在最右端，</strong>(a)**可以放在最前面</p>
</li>
<li>
<p>上面的是SDD，而下面的则是SDT(一条可以展平的串)：</p>
</li>
</ul>
<p><img src="D:%5CTypora_picture%5C4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC%5Cimage-20231024104457331.png" alt="image-20231024104457331"></p>
<h2 id="实现L属性的SDD">实现L属性的SDD</h2>
<p><strong>L属性SDD的实现</strong></p>
<ul>
<li>使用递归下降的语法分析器
<ul>
<li>每个非终结符号对应一个函数 S.next -&gt; S(next)</li>
<li>函数的参数<strong>接受继承属性</strong>，返回值包含了<strong>综合属性</strong></li>
</ul>
</li>
<li>在函数体中
<ul>
<li>首先选择适当的产生式</li>
<li>使用<strong>局部变量</strong>来保存属性(避免副作用)</li>
<li>对于产生式体中的<strong>终结符号</strong>，读入符号并获取其(经词法分析得到的)<strong>综合属性</strong></li>
<li>对于<strong>非终结符号</strong>，使用适当的方式调用相应函数，并<strong>记录返回值</strong></li>
</ul>
</li>
<li>示例</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231024111120296.png" alt="image-20231024111120296" style="zoom:50%;" />
<p><strong>边扫描边生成属性</strong></p>
<ul>
<li>当属性值的体积很大，对其进行运算会效率很低
<ul>
<li>code可能是一个上百K的串</li>
<li>许多代码片段被反复复制，很低效</li>
</ul>
</li>
<li>可逐步生成属性的各个部分，并增量式地添加到最终的属性值中</li>
<li>前提条件
<ul>
<li>存在一个主属性，且其为综合属性</li>
<li>在产生式中，主属性是通过产生式体中<strong>各非终结符号的主属性连接</strong>而得到，同时还会连接一些其它元素</li>
<li>各个非终结符号的主属性的连接顺序与它们在<strong>产生式体中的顺序</strong>相同</li>
</ul>
</li>
<li>基本思想
<ul>
<li>在适当的时候“发出”（emit）元素，保证其能被<strong>适当地拼接</strong></li>
</ul>
</li>
<li>示例
<ul>
<li>假设扫描一个非终结符号对应的语法结构，调用其相应的函数，并生成主属性
<ul>
<li>S -&gt; while © S~1~</li>
<li>{S.code = label || L~1~ || C.code || label || L~2~ || S~1~.code }</li>
</ul>
</li>
<li>如果各函数都把其主属性 (code) 打印出来，则对while语句，只需<strong>先打印label L1</strong>，再<strong>调用C</strong> (打印C的代码)，再<strong>打印label L2</strong>，再<strong>调用S</strong> (打印S1的代码)</li>
<li>需要在适当的时候打印label L~1~和label L~2~</li>
</ul>
</li>
</ul>
<img src="D:\Typora_picture\4_语法制导\image-20231024112224668.png" alt="image-20231024112224668" style="zoom: 67%;" />
<p><img src="D:%5CTypora_picture%5C4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC%5Cimage-20231024112419938.png" alt="image-20231024112419938"></p>
<p><img src="D:%5CTypora_picture%5C4_%E8%AF%AD%E6%B3%95%E5%88%B6%E5%AF%BC%5Cimage-20231024112433106.png" alt="image-20231024112433106"></p>
<h2 id="总结">总结</h2>
<ul>
<li><strong>语义分析</strong>
<ul>
<li>检查程序是否符合语言的语义规则</li>
<li>类型规则、变量使用规则、函数调用规则……</li>
</ul>
</li>
<li><strong>语法制导定义 (Syntax-Directed Definition)</strong>
<ul>
<li>文法、属性 (继承/综合)、产生式规则</li>
<li>属性值表示语义信息、产生式规则计算语义信息</li>
</ul>
</li>
<li><strong>SDD的其它应用</strong>
<ul>
<li>抽象语法树 (AST)、代码翻译</li>
</ul>
</li>
<li><strong>语法制导翻译 (Syntax-Directed Translation)</strong>
<ul>
<li>明确指定SDD语义动作的执行时机</li>
<li>SDT的实现 (遍历语法树/与语法分析同步进行)</li>
</ul>
</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/12/05/DIP_4/" rel="prev" title="文献研读:《RIS-GAN：利用生成对抗网络探索残影和光照的去影技术》">
                  <i class="fa fa-angle-left"></i> 文献研读:《RIS-GAN：利用生成对抗网络探索残影和光照的去影技术》
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/02/12/CF_3/" rel="next" title="">
                   <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">ZhangChengWei</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM=" crossorigin="anonymous">



</body>
</html>
