<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.19.1","exturl":false,"sidebar":{"position":"left","Sidebar Display (only for Muse | Mist), available values":["hide    expand only when click on the sidebar toggle icon."],"display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="...">
<meta property="og:type" content="article">
<meta property="og:title" content="Program Analysis 7ï¼šInterproducedural Analysis">
<meta property="og:url" content="http://example.com/2024/04/15/PA_7/index.html">
<meta property="og:site_name" content="Blog of ZhangCW">
<meta property="og:description" content="...">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240402001532527.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240402144346261.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240402144530055.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240402144624000.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240402144912636.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240402145108229.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240402145437628.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240402150112557.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240402150535057.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240402153903515.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240402151413760.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240402153129864.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240402153839288.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240404160143784.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240404162119271.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240404162411071.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240404165254093.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240404172237723.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240407190711731.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240407192922276.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240407192637921.png">
<meta property="og:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240407192850179.png">
<meta property="article:published_time" content="2024-04-15T14:35:37.000Z">
<meta property="article:modified_time" content="2024-04-15T08:30:11.747Z">
<meta property="article:author" content="ZhangChengWei">
<meta property="article:tag" content="PA">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/7_%E8%BF%87%E7%A8%8B%E9%97%B4%E5%88%86%E6%9E%90/image-20240402001532527.png">


<link rel="canonical" href="http://example.com/2024/04/15/PA_7/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2024/04/15/PA_7/","path":"2024/04/15/PA_7/","title":"Program Analysis 7ï¼šInterproducedural Analysis"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Program Analysis 7ï¼šInterproducedural Analysis | Blog of ZhangCW</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Blog of ZhangCW</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">By ZhangCW</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-text">Interproducedural Analysis</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Motivation"><span class="nav-text">Motivation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Call-Graph-Construction-CHA"><span class="nav-text">Call Graph Construction (CHA)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Applications-of-Call-Graph"><span class="nav-text">Applications of Call Graph</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Call-Graph-Construction-for-OOPLs-focus-on-Java"><span class="nav-text">Call Graph Construction for OOPLs (focus on Java)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Method-Calls-Invocations-in-Java"><span class="nav-text">Method Calls (Invocations) in Java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Method-Dispatch-of-Virtual-Calls"><span class="nav-text">Method Dispatch of Virtual Calls</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Class-Hierarchy-Analysisi-CHA"><span class="nav-text">Class Hierarchy Analysisi* (CHA)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Call-Resolution-of-CHA"><span class="nav-text">Call Resolution of CHA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Features-of-CHA"><span class="nav-text">Features of CHA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Call-Graph-Construction-via-CHA"><span class="nav-text">Call Graph Construction (via CHA)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Interprocedural-Control-Flow-Graph"><span class="nav-text">Interprocedural Control-Flow Graph</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Interprocedural-Data-Flow-Analysis"><span class="nav-text">Interprocedural Data-Flow Analysis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Interprocedural-Constant-Propagation-In-Summary"><span class="nav-text">Interprocedural Constant Propagation, In Summary</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Focus-Key"><span class="nav-text">Focus Key</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ZhangChengWei</p>
  <div class="site-description" itemprop="description">paper analysis</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">41</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">åˆ†ç±»</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">æ ‡ç­¾</span>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/04/15/PA_7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ZhangChengWei">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog of ZhangCW">
      <meta itemprop="description" content="paper analysis">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Program Analysis 7ï¼šInterproducedural Analysis | Blog of ZhangCW">
      <meta itemprop="description" content="...">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Program Analysis 7ï¼šInterproducedural Analysis
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>
      

      <time title="åˆ›å»ºæ—¶é—´ï¼š2024-04-15 22:35:37 / ä¿®æ”¹æ—¶é—´ï¼š16:30:11" itemprop="dateCreated datePublished" datetime="2024-04-15T22:35:37+08:00">2024-04-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/PA/" itemprop="url" rel="index"><span itemprop="name">PA</span></a>
        </span>
    </span>

  
</div>

            <div class="post-description">...</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1>Interproducedural Analysis</h1>
<h2 id="Motivation">Motivation</h2>
<ul>
<li>So far, all analyses we learnt are <strong>intraprocedural</strong> (è¿‡ç¨‹å†…çš„). How to deal with method calls?
<ul>
<li>Make the most conservative (ä¿å®ˆçš„) assumption for method calls, for safe-approximation (è¿‡ç¨‹å†…åˆ†æå¯¹å‡½æ•°è°ƒç”¨åšæœ€ä¿å®ˆçš„ä¼°è®¡)</li>
<li>Source of imprecision
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>N</mi><mi>A</mi><mi>C</mi><mo separator="true">,</mo><mtext>Â </mtext><mi>y</mi><mo>=</mo><mi>N</mi><mi>A</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">x=NAC,\ y=NAC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>N</mi><mi>A</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">n=NAC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240402001532527.png" alt="image-20240402001532527" style="zoom:50%;" />
<ul>
<li>For better precision, we need Interprocedural analysis: propagate data-flow information along <strong>interprocedural control-flow edges</strong>
<ul>
<li><strong>è¿‡ç¨‹é—´åˆ†æ</strong>ï¼šæ²¿ç€<strong>è¿‡ç¨‹é—´æ§åˆ¶æµè¾¹</strong>ä¼ æ’­æ•°æ®æµä¿¡æ¯ã€‚å¦‚ call and return edges</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>42</mn><mo separator="true">,</mo><mtext>Â </mtext><mi>y</mi><mo>=</mo><mn>43</mn></mrow><annotation encoding="application/x-tex">x=42,\ y=43</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">42</span><span class="mpunct">,</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">43</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">n=10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span></li>
</ul>
</li>
<li>To perform interprocedural analysis, we need <strong>call graph</strong>.</li>
</ul>
<h2 id="Call-Graph-Construction-CHA">Call Graph Construction (CHA)</h2>
<ul>
<li>A representation of calling relationships in the program
<ul>
<li>Essentially, a call graph is <strong>a set of call edges</strong> from call-sites to their target methods (callees)</li>
</ul>
</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240402144346261.png" alt="image-20240402144346261" style="zoom:50%;" />
<h3 id="Applications-of-Call-Graph">Applications of Call Graph</h3>
<ul>
<li>Foundation of all interprocedural analyses</li>
<li>Program optimization</li>
<li>Program understanding</li>
<li>Program debugging</li>
<li>Program testing</li>
<li>And many more â€¦</li>
</ul>
<h3 id="Call-Graph-Construction-for-OOPLs-focus-on-Java">Call Graph Construction for OOPLs (focus on Java)</h3>
<ul>
<li>Class hierarchy analysis (CHA)</li>
<li>Rapid type analysis (RTA)</li>
<li>Variable type analysis (VTA)</li>
<li>Pointer analysis (k-CFA)</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240402144530055.png" alt="image-20240402144530055" style="zoom:50%;" />
<h3 id="Method-Calls-Invocations-in-Java">Method Calls (Invocations) in Java</h3>
<ul>
<li>Javaä¸­çš„è°ƒç”¨ä¸»è¦åˆ†ä¸ºä¸‰å¤§ç±»ï¼Œå¯¹åº”äº†å››ç§æŒ‡ä»¤ï¼ŒJava8å¼€å§‹è¿˜å¼•å…¥äº†invokedynamicï¼Œä¸»è¦ç”¨äºå®ç°åŠ¨æ€ç±»å‹è¯­è¨€çš„ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¸è¿›è¡Œè®¨è®ºã€‚
<ul>
<li><strong>invokestatic</strong>: è°ƒç”¨çš„ç›®æ ‡æ–¹æ³•æ˜¯ static methods (é™æ€æ–¹æ³•ï¼Œå®ƒä»¬å±äº<strong>ç±»æœ¬èº«</strong>ï¼Œä¸å±äºç±»çš„<strong>ç‰¹å®šå®ä¾‹</strong>)ï¼Œæ•…æ²¡æœ‰ reciever objectï¼Œç›®æ ‡ä¸ªæ•°ä¸ºä¸€ä¸ªï¼Œå¯åœ¨ç¼–è¯‘æœŸç¡®å®šã€‚</li>
<li><strong>invokespecial</strong>: è°ƒç”¨æ„é€ å‡½æ•°ã€è°ƒç”¨ç§æœ‰çš„å®ä¾‹æ–¹æ³•ã€è°ƒç”¨çˆ¶ç±»çš„å®ä¾‹æ–¹æ³•ï¼Œå®ƒçš„ç›®æ ‡ä¸ªæ•°ä¹Ÿæ˜¯åªæœ‰1ä¸ªï¼Œåœ¨ç¼–è¯‘æœŸå¯ä»¥ç¡®å®šã€‚</li>
<li><strong>invokeinterface, invokevirtual</strong>: è°ƒç”¨å…¶ä»–çš„å®ä¾‹æ–¹æ³•ï¼Œå› ä¸ºæœ‰<strong>å¤šæ€</strong>çš„å­˜åœ¨ï¼Œæ‰€ä»¥å¯èƒ½è°ƒç”¨ä¸åŒçš„æ–¹æ³•ï¼Œç›®æ ‡æ–¹æ³•å¯èƒ½å¤§äºä¸€ä¸ªï¼Œå…·ä½“è°ƒç”¨çš„æ–¹æ³•è¦åœ¨<strong>è¿è¡Œæ—¶</strong>ç¡®å®šã€‚</li>
</ul>
</li>
<li><strong>Virtual call</strong> is the <strong>key</strong> to call graph construction for OOPLs</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240402144624000.png" alt="image-20240402144624000" style="zoom: 50%;" />
<h3 id="Method-Dispatch-of-Virtual-Calls">Method Dispatch of Virtual Calls</h3>
<ul>
<li>During run-time, a virtual call is resolved based on
<ul>
<li>type of the <strong>receiver object</strong> (pointed by o) : <strong>ğ‘</strong></li>
<li><strong>method signature</strong> at the call site : <strong>ğ‘š</strong></li>
</ul>
</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240402144912636.png" alt="image-20240402144912636" style="zoom:50%;" />
<ul>
<li>In this lecture, a <strong>signature</strong> acts as an <strong>identifier</strong> of a method (ç­¾åå”¯ä¸€ç¡®å®šæ–¹æ³•)
<ul>
<li><strong>å®šä¹‰æ–¹æ³•çš„ç±»</strong>ã€<strong>æ–¹æ³•å</strong>ã€Descriptor (åŒ…æ‹¬<strong>è¿”å›ç±»å‹</strong>å’Œ<strong>å‚æ•°ç±»å‹</strong>)</li>
</ul>
</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240402145108229.png" alt="image-20240402145108229" style="zoom:50%;" />
<ul>
<li>We define function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>i</mi><mi>s</mi><mi>p</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mo stretchy="false">(</mo><mi>ğ‘</mi><mo separator="true">,</mo><mi>ğ‘š</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Dispatch(ğ‘, ğ‘š)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span> to simulate the procedure of run-time method dispatch (è¿™ä¸ªå‡½æ•°æ¨¡æ‹ŸåŠ¨æ€æ—¶ Method dispatch çš„è¿‡ç¨‹)
<ul>
<li>å¦‚æœ ğ‘ ç±»ä¸­åŒ…å«ä¸€ä¸ª<strong>éæŠ½è±¡</strong>çš„æ–¹æ³• ğ‘šâ€²ï¼Œå¹¶ä¸”å…¶ä¸ ğ‘š æ‹¥æœ‰ä¸€æ ·çš„ name å’Œ descriptorï¼Œé‚£ä¹ˆ ğ‘šâ€² å°±ç¡®å®šä¸ºè¿™ä¸ªæ–¹æ³•ï¼Œè¢«å‡½æ•°è¿”å›ã€‚
<ul>
<li>æ³¨æ„ï¼Œè°ƒç”¨çš„æ–¹æ³•ä¸€å®šæœ‰å‡½æ•°ä½“ï¼Œæ‰€ä»¥æ˜¯éæŠ½è±¡çš„</li>
</ul>
</li>
<li>å¦‚æœ ğ‘ ç±»ä¸­æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æ–¹æ³•ï¼Œé‚£ä¹ˆå°±ä¼šå¯¹ ğ‘ çš„<strong>çˆ¶ç±»</strong>é‡å¤è¿™ä¸ª Dispatch çš„è¿‡ç¨‹ã€‚</li>
</ul>
</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240402145437628.png" alt="image-20240402145437628" style="zoom:50%;" />
<ul>
<li><strong>Example</strong>
<ul>
<li>Dispatch(B, A.foo()) = ?
<ul>
<li>A.foo()</li>
</ul>
</li>
<li>Dispatch(C, A.foo()) = ?
<ul>
<li>C.foo()</li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240402150112557.png" alt="image-20240402150112557" style="zoom:50%;" />
<h2 id="Class-Hierarchy-Analysisi-CHA">Class Hierarchy Analysisi* (CHA)</h2>
<ul>
<li>Require the <strong>class hierarchy information</strong> (inheritance structure) of the whole program. CHA æ–¹æ³•éœ€è¦ç±»å±‚æ¬¡ç»“æ„ä¿¡æ¯ (ç»§æ‰¿ä¿¡æ¯)</li>
<li>Resolve a virtual call based on the <strong>declared type</strong> (å£°æ˜ç±»å‹) of <strong>receiver variable</strong> (æ¥æ”¶å˜é‡) of the call site. ä¸‹å›¾çš„ call site ä¸º aï¼Œå…¶å£°æ˜ç±»å‹ä¸º A</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240402150535057.png" alt="image-20240402150535057" style="zoom:50%;" />
<ul>
<li>Assume the receiver variable a may point to objects of <strong>class A</strong> or <strong>all subclasses of A</strong>. å‡è®¾å˜é‡ a å¯ä»¥æŒ‡å‘ A ç±»ä»¥åŠæ‰€æœ‰ A çš„å­ç±»çš„å¯¹è±¡ï¼ŒCHA å»è§£ç›®æ ‡æ–¹æ³•çš„è¿‡ç¨‹å°±æ˜¯å»æŸ¥è¯¢ A ç±»çš„<strong>ç»§æ‰¿ç»“æ„</strong> class hierarchyã€‚
<ul>
<li>Resolve target methods by looking up the <strong>class hierarchy</strong> of class A</li>
</ul>
</li>
</ul>
<h3 id="Call-Resolution-of-CHA">Call Resolution of CHA</h3>
<ul>
<li>We define function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>s</mi><mi>o</mi><mi>l</mi><mi>v</mi><mi>e</mi><mo stretchy="false">(</mo><mi>c</mi><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Resolve(cs)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">eso</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord mathnormal">cs</span><span class="mclose">)</span></span></span></span> to resolve <strong>possible target methods</strong> of a call site <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">cs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">cs</span></span></span></span> by CHA, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> = method signature at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">cs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">cs</span></span></span></span>
<ul>
<li>ä¼ å…¥çš„å‚æ•°ä¸ºè°ƒç”¨ç‚¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">cs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">cs</span></span></span></span></li>
<li>åˆå§‹åŒ– <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> ä¸ºç©ºï¼Œå­˜æ”¾ç›®æ ‡æ–¹æ³•</li>
<li>ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> ä¿å­˜ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">cs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">cs</span></span></span></span> ç‚¹å¤„çš„æ–¹æ³•ç­¾å</li>
</ul>
</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240402153903515.png" alt="image-20240402153903515" style="zoom:67%;" />
<ul>
<li>For <strong>static call</strong>, ç›®æ ‡æ–¹æ³•å°±æ˜¯å†™åœ¨call siteä¸­çš„æ–¹æ³•ï¼Œç­¾åå°±æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>ã€‚å¦‚ä¸‹å›¾ï¼Œç›´æ¥ç”¨ç±» C è°ƒç”¨æ–¹æ³•è€Œ<strong>ä¸éœ€è¦å®šä¹‰å¯¹è±¡ c</strong>ï¼Œå¾ˆæ˜æ˜¾è°ƒç”¨çš„å°±æ˜¯ C çš„æ–¹æ³•ï¼Œæ‰€ä»¥å¯ç›´æ¥åŠ åˆ°é›†åˆTä¸­ã€‚</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240402151413760.png" alt="image-20240402151413760" style="zoom:50%;" />
<ul>
<li>For <strong>special call</strong>, éœ€è¦å¤„ç†<strong>æ„é€ å‡½æ•°</strong>ã€<strong>ç§æœ‰æ–¹æ³•</strong>ã€<strong>çˆ¶ç±»æ–¹æ³•</strong>ä¸‰ç§æƒ…å†µã€‚
<ul>
<li>ä»¥çˆ¶ç±»æ–¹æ³•ä¸ºä¾‹ï¼Œå¦‚å›¾æ‰€ç¤ºï¼ŒC ç±»ç»§æ‰¿ B ç±»ï¼ŒC ç±»é‡Œæœ‰ä¸€ä¸ª super è°ƒç”¨ï¼Œè¿™ä¸ª foo() è™½ç„¶åœ¨å½“å‰ç±»æœ‰å®šä¹‰ï¼Œä½†æ˜¯<strong>å®é™…ä½¿ç”¨çš„æ˜¯çˆ¶ç±» B çš„ foo()</strong>ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨Dispatchå‡½æ•° (å› ä¸º B ç±»ä¸ä¸€å®šå°±æœ‰è¿™ä¸ª foo æ–¹æ³•ï¼ŒB ç»§æ‰¿è‡ª Aï¼Œfoo æ–¹æ³•ä¸ä¸€å®šæ˜¯ B çš„ï¼Œæ‰€ä»¥éœ€è¦å†ç”¨dispatch)ï¼Œå…¶ä¸­çš„ foo() çš„<strong>ç­¾å</strong> m ç”±ç¼–è¯‘å™¨è¿”å›ä¿¡æ¯å¯ä»¥çŸ¥é“<strong>æ˜¯ B çš„</strong>ï¼Œé‚£ä¹ˆè·å– foo() è¿”å›å€¼çš„ c ä¹ŸæŒ‡å‘ Bï¼Œä¹Ÿå°±ç›¸å½“äºåœ¨çˆ¶ç±»ä¸­å¯»æ‰¾äº†ã€‚</li>
<li>å¯¹äºç§æœ‰æ–¹æ³•å’Œæ„é€ å‡½æ•°ï¼Œç›®æ ‡æ–¹æ³•å…¶å®ä¸ static call ä¸€æ ·ï¼Œå°±æ˜¯å†™åœ¨ç­¾åé‡Œçš„ m</li>
</ul>
</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240402153129864.png" alt="image-20240402153129864" style="zoom:50%;" />
<ul>
<li>For <strong>virtual call</strong>, é¦–å…ˆä¼šå–å‡º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">cs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">cs</span></span></span></span> ä½ç½®ä¸Šçš„<strong>æ¥æ”¶å˜é‡çš„å£°æ˜ç±»å‹</strong> (declared type)ï¼Œè¿™é‡Œæ˜¯Cï¼Œæ¥ä¸‹æ¥ä¼šå¯¹ <strong>C åŠå…¶ç»§æ‰¿æ ‘ä¸Šçš„æ‰€æœ‰å­ç±»</strong>ï¼Œè¿™é‡Œå®šä¹‰ä¸ºcâ€™ï¼Œè°ƒç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>i</mi><mi>s</mi><mi>p</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mo stretchy="false">(</mo><msup><mi>c</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Dispatch(c&#x27;, m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span>ï¼Œå¹¶å°†æ‰€æœ‰çš„ç»“æœéƒ½åŠ åˆ°Tä¸­ã€‚</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240402153839288.png" alt="image-20240402153839288" style="zoom:50%;" />
<ul>
<li><strong>Example</strong>
<ul>
<li>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæœ‰4ä¸ªç±»ï¼Œå…¶ä¸­ A æœ‰fooæ–¹æ³•ï¼ŒCã€D éƒ½å¤å†™äº†fooæ–¹æ³•</p>
</li>
<li>
<p>æœ‰3ä¸ªcall siteï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ±‚æ¯ä¸ªcall siteçš„ç›®æ ‡æ–¹æ³•</p>
<ul>
<li>Resolve(c.foo()) = {C.foo()} ï¼Œè¿™é‡Œæ˜¯virtual callï¼Œæ‰€ä»¥ä¼šæŠŠ <strong>C åŠå…¶å­ç±»</strong>è¿›è¡Œdispatchï¼Œåˆå› ä¸º C <strong>æ²¡æœ‰å­èŠ‚ç‚¹</strong>ï¼Œæ‰€ä»¥åªéœ€è¦å¯¹ C è¿›è¡Œdispatchï¼ˆdispatch çš„ä½œç”¨æ˜¯éå†è¿™ä¸ª class çœ‹çœ‹æœ‰æ²¡æœ‰å¯¹åº”å‡½æ•°ï¼Œæ²¡æœ‰çš„è¯å†éå†å…¶<strong>çˆ¶ç±»</strong>ï¼‰ï¼ŒCæœ‰fooï¼Œ<strong>ä¸éœ€è¦éå†å…¶çˆ¶èŠ‚ç‚¹</strong>ï¼Œæ‰€ä»¥ç­”æ¡ˆä¸º{C.foo()}</li>
<li>Resolve(a.foo()) = {A.foo(), C.foo(), D.foo()} ï¼ŒåŒç†ï¼Œä¼šæŠŠ A åŠå…¶å­ç±»è¿›è¡Œ dispatchï¼Œä¹Ÿå°±æ˜¯å¯¹ A B C D è¿›è¡Œdispatchï¼Œå¯¹A dispatchçš„ç»“æœå°±æ˜¯Aï¼Œå¯¹B dispatchçš„æ—¶å€™ï¼ŒB æ²¡æœ‰ fooï¼Œæ‰€ä»¥ä¼šæ‰¾å…¶çˆ¶ç±»ï¼Œç»“æœä¹Ÿæ˜¯ Aï¼Œå†å¯¹ B çš„å­ç±» C D åˆ†åˆ«è¿›è¡Œdispatchï¼Œç»“æœåŠ å…¥ C Dï¼Œæ‰€ä»¥ç­”æ¡ˆä¸º A C D</li>
<li>Resolve(b.foo()) = {A.foo(), C.foo(), D.foo()} ï¼Œè¿™é‡Œä¼šå…ˆå¯¹ B, C, D åˆ†åˆ«è¿›è¡Œ dispatchï¼Œå¯¹ B dispatch çš„æ—¶å€™ï¼ŒB æ²¡æœ‰ fooï¼Œæ‰€ä»¥ä¼šæ‰¾åˆ°å…¶<strong>çˆ¶ç±» A</strong>ï¼ŒA æœ‰ foo()ï¼Œæ‰€ä»¥ç»“æœåŠ å…¥ Aï¼Œå†å¯¹ C D è¿›è¡Œ dispatchï¼ŒåŒç†ï¼Œç­”æ¡ˆä¹Ÿæ˜¯ A C D</li>
</ul>
</li>
<li>
<p>å‡å¦‚ç¬¬3ä¸ªæƒ…å†µä¸­ï¼ŒæŒ‡å®š B b = new B() å‘¢ï¼Ÿ</p>
<ul>
<li>CHA <strong>åªè€ƒè™‘å˜é‡çš„å£°æ˜ç±»å‹</strong>ï¼Œå“ªæ€•å†™äº†B b = new B()ï¼Œè¿™é‡Œè¿˜æ˜¯ä¼šæ ¹æ®å…¶å£°æ˜ç±»å‹ B æ¥è§£ç›®æ ‡æ–¹æ³•ï¼Œæ‰€ä»¥ç­”æ¡ˆä»æ˜¯A C D</li>
<li>è¿™ä¹Ÿæ˜¯ CHA çš„ä¸€ä¸ªé—®é¢˜ï¼ŒC.foo() å’Œ D.foo() å¯¹äºè¿™ä¸ªæƒ…å†µæ¥è¯´æ˜¯<strong>è™šå‡</strong>çš„ç›®æ ‡æ–¹æ³• (spurious call targets)ã€‚CHA åªè€ƒè™‘å£°æ˜ç±»å‹ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´<strong>ç²¾åº¦çš„ä¸‹é™</strong>ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240404160143784.png" alt="image-20240404160143784" style="zoom:50%;" />
<h3 id="Features-of-CHA">Features of CHA</h3>
<ul>
<li>Advantage: <strong>fast</strong>
<ul>
<li>Only consider <strong>the declared type</strong> of <strong>receiver variable</strong> at the call-site, and its <strong>inheritance hierarchy</strong> (åªè€ƒè™‘åœ¨è°ƒç”¨ç‚¹ä¸Š<strong>æ¥æ”¶å˜é‡çš„å£°æ˜ç±»å‹</strong>åŠå…¶<strong>ç»§æ‰¿å±‚æ¬¡</strong>ç»“æ„)</li>
<li>Ignore data- and control-flow information (å¿½ç•¥<strong>æ•°æ®</strong>å’Œ<strong>æ§åˆ¶æµä¿¡æ¯</strong>)</li>
</ul>
</li>
<li>Disadvantage: <strong>imprecise</strong>
<ul>
<li>Easily introduce spurious target methods (å®¹æ˜“å¯¼è‡´<strong>å‡çš„ç›®æ ‡æ–¹æ³•</strong>)</li>
<li>Addressed in next lectures</li>
</ul>
</li>
<li>Common usage: IDE</li>
</ul>
<h3 id="Call-Graph-Construction-via-CHA">Call Graph Construction (via CHA)</h3>
<ul>
<li>Build call graph for whole program via CHA
<ul>
<li>Start from <strong>entry methods</strong> (focus on main method)</li>
<li>For each <strong>reachable method</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ‘š</mi></mrow><annotation encoding="application/x-tex">ğ‘š</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>, resolve target methods for each call site <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">cs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">cs</span></span></span></span> in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ‘š</mi></mrow><annotation encoding="application/x-tex">ğ‘š</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> via CHA (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>s</mi><mi>o</mi><mi>l</mi><mi>v</mi><mi>e</mi><mo stretchy="false">(</mo><mi>c</mi><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Resolve(cs)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">eso</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord mathnormal">cs</span><span class="mclose">)</span></span></span></span>)</li>
<li>Repeat until no new method is discovered</li>
</ul>
</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240404162119271.png" alt="image-20240404162119271" style="zoom:50%;" />
<ul>
<li>Algorithm
<ul>
<li>ä» main å¼€å§‹ï¼Œä» <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> ä¸­å–å‡ºä¸€ä¸ªæ–¹æ³• <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>ï¼Œå¦‚æœå®ƒæ²¡æœ‰è¢«å¤„ç†è¿‡ (ä¸åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">RM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">RM</span></span></span></span> ä¸­)ï¼Œå°±å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> ä¸­æ‰€æœ‰çš„ call site è¿›è¡Œ resolve åˆ†æï¼Œè·å¾—ç›®æ ‡æ–¹æ³•é›†åˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>ï¼Œå°†å…¶ä¸­çš„<strong>ç›®æ ‡æ–¹æ³•</strong>æ”¾å…¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> ä¸­ï¼Œå¹¶åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>G</mi></mrow><annotation encoding="application/x-tex">CG</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">CG</span></span></span></span> ä¸­åŠ ä¸Š<strong>è°ƒç”¨è¾¹</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>s</mi><mo>â†’</mo><msup><mi>m</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><annotation encoding="application/x-tex">cs â†’ m&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">cs</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span>ã€‚ç„¶åå¾ªç¯å†å¯¹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> ä¸­çš„æ–¹æ³•è¿›è¡Œåˆ†æï¼Œç›´åˆ° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> ä¸ºç©º</li>
<li>ç±»ä¼¼äºå¸¦æ ‡è®°çš„ BFS</li>
</ul>
</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240404162411071.png" alt="image-20240404162411071" style="zoom:50%;" />
<ul>
<li>Example
<ul>
<li>Initializationï¼š <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> = [A.main()]
<ul>
<li>å–å‡ºæ–¹æ³• A.main()ï¼Œå°†å…¶åŠ å…¥å¯è¾¾é›†åˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">RM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">RM</span></span></span></span> ä¸­ï¼Œæ±‚è§£å…¶ä¸­çš„ call siteï¼Œå³ A.foo()ï¼Œæ±‚å¾— Resolve(A.foo())={A.foo()}ï¼Œæ„é€  A.main() â†’ A.foo() çš„ä¸€æ¡è¾¹ï¼Œå¹¶å°† A.foo() åŠ å…¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> ä¸­</li>
</ul>
</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> = [A.foo()]
<ul>
<li>å–å‡ºæ–¹æ³• A.foo()ï¼Œå°†å…¶åŠ å…¥å¯è¾¾é›†åˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">RM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">RM</span></span></span></span> ä¸­ï¼Œæ±‚è§£å…¶ä¸­çš„ call site (è¿™é‡Œä¸è€ƒè™‘æ„é€ å‡½æ•°)ï¼Œå³ a.bar()ï¼Œæ±‚å¾— Resolve(a.bar())={A.bar(), B.bar(), C.bar()}ï¼Œæ„é€ ä¸‹å›¾å³ä¾§çš„ä¸‰æ¡è¾¹ï¼Œå¹¶å°†å®ƒä»¬åŠ å…¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> ä¸­</li>
</ul>
</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> = [A.bar(), B.bar(), C.bar()]
<ul>
<li>åŒç†ï¼Œå–å‡º A.bar()ï¼Œå°†å…¶åŠ å…¥å¯è¾¾é›†åˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">RM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">RM</span></span></span></span> ä¸­ï¼ŒResolve(c.bar()) = {C.bar()}ï¼Œæ„é€ ä¸‹å›¾å·¦ä¾§å†…éƒ¨è¾¹ï¼Œå¹¶å°† C.bar() åŠ å…¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> ä¸­</li>
</ul>
</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> = [B.bar(), C.bar(), C.bar()]
<ul>
<li>åŒç†ï¼Œå–å‡º B.bar()ï¼Œå…¶æ–¹æ³•ä½“ä¸ºç©ºï¼Œä¸éœ€è¦è¿›è¡Œæ“ä½œ</li>
</ul>
</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> = [C.bar(), C.bar()]
<ul>
<li>åŒç†ï¼Œå–å‡º C.bar()ï¼Œå°†å…¶åŠ å…¥å¯è¾¾é›†åˆ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">RM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">RM</span></span></span></span> ä¸­ï¼ŒResolve(c.bar()) = {A.foo()}ï¼Œæ„é€ ä¸‹å›¾å·¦ä¾§å¤–éƒ¨è¾¹ï¼Œå¹¶å°† A.foo() åŠ å…¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> ä¸­</li>
</ul>
</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> = [C.bar(), A.foo()]
<ul>
<li>å–å‡º C.bar()ï¼Œå®ƒå·²ç»åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">RM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">RM</span></span></span></span> ä¸­äº†ï¼Œä¸éœ€è¦è¿›è¡Œæ“ä½œ</li>
</ul>
</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> = [A.foo()]
<ul>
<li>å–å‡º A.foo()ï¼Œå®ƒå·²ç»åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">RM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">RM</span></span></span></span> ä¸­äº†ï¼Œä¸éœ€è¦è¿›è¡Œæ“ä½œ</li>
</ul>
</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">WL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">L</span></span></span></span> = []
<ul>
<li>ç®—æ³•ç»“æŸ</li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240404165254093.png" alt="image-20240404165254093" style="zoom:50%;" />
<h2 id="Interprocedural-Control-Flow-Graph">Interprocedural Control-Flow Graph</h2>
<ul>
<li>CFG represents structure of an <strong>individual method</strong> <strong>å•ä¸ªæ–¹æ³•</strong>çš„ç»“æ„</li>
<li>ICFG represents structure of the <strong>whole program</strong> <strong>æ•´ä¸ªç¨‹åº</strong>çš„ç»“æ„
<ul>
<li>With ICFG, we can perform interprocedural analysis</li>
</ul>
</li>
<li>An ICFG of a program <strong>consists</strong> of CFGs of the methods in the program, <strong>plus two kinds of additional edges</strong>:
<ul>
<li><strong>Call edges</strong>: from call sites to the entry nodes of their callees
<ul>
<li>ä»<strong>è°ƒç”¨ç‚¹</strong> call sites è¿æ¥åˆ°å…¶<strong>ç›®æ ‡æ–¹æ³•</strong> callees çš„<strong>å…¥å£</strong> entry nodes</li>
</ul>
</li>
<li><strong>Return edges</strong>: from exit nodes of the callees to the statements following their call sites (i.e., return sites)
<ul>
<li>ä» <strong>return è¯­å¥</strong>è¿æ¥åˆ°<strong>ç´§è·Ÿç€çš„è°ƒç”¨ç‚¹</strong>call sitesçš„<strong>ä¸‹ä¸€ä¸ªè¯­å¥</strong> (è¿”å›ç‚¹)</li>
</ul>
</li>
</ul>
</li>
<li>ICFG = CFGs + call egdes &amp; return edges
<ul>
<li>è¿æ¥è¿™ä¸¤ç§è¾¹çš„ä¿¡æ¯æ¥è‡ª <strong>call graph</strong></li>
</ul>
</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240404172237723.png" alt="image-20240404172237723" style="zoom:50%;" />
<ul>
<li>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒICFG å°±æ˜¯ CFG åŠ ä¸Šä¸¤ç§è¾¹ï¼Œä½†ä¸ºä½•è¿˜è¦ä¿ç•™è“çº¢è™šçº¿ä¹‹é—´çš„åŸæœ‰è¾¹å‘¢ï¼Ÿ
<ul>
<li>è¿™ä¸ªè¾¹ (ä»call site åˆ°return siteçš„è¾¹) å«åš call-to-return edgeï¼Œè¿™ä¸ªè¾¹å¯ä»¥ç”¨æ¥<strong>åœ¨ ICFG ä¸­ä¼ æ’­æœ¬åœ°æ•°æ®æµ</strong> (å°±æ˜¯å‡½æ•°å†…éƒ¨çš„æ•°æ®æµ)ã€‚</li>
<li>å¦‚æœæ²¡æœ‰è¿™æ¡è¾¹ï¼Œæˆ‘ä»¬éœ€è¦è·¨è¶Šå…¶ä»–æ–¹æ³•æ¥ä¼ æ’­æœ¬åœ°æ•°æ®æµï¼Œè¿™æ˜¯éå¸¸ä½æ•ˆçš„ã€‚</li>
</ul>
</li>
</ul>
<h2 id="Interprocedural-Data-Flow-Analysis">Interprocedural Data-Flow Analysis</h2>
<ul>
<li>Analyzing the whole program with method calls based on interprocedural control-flow graph (ICFG)</li>
<li>è¿‡ç¨‹å†…ä¸»è¦æ˜¯å…³æ³¨æ¯ä¸ªCFGï¼Œè€Œè¿‡ç¨‹é—´éœ€è¦åŠ ä¸Šè°ƒç”¨å’Œè¿”å›è¾¹ï¼Œåœ¨è½¬æ¢å‡½æ•°ä¸­ï¼Œè¿‡ç¨‹é—´è¿˜éœ€è¦åŠ ä¸Šä¸¤ç§è¾¹çš„è½¬æ¢å‡½æ•°edge transfer</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">Intraprocedural</th>
<th style="text-align:center">Interprocedural</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Program representation</td>
<td style="text-align:center">CFG</td>
<td style="text-align:center">ICFG = CFGs + call&amp;return edges</td>
</tr>
<tr>
<td style="text-align:center">Transfer functions</td>
<td style="text-align:center">Node transfer</td>
<td style="text-align:center">Node transfer + edge transfer</td>
</tr>
</tbody>
</table>
<ul>
<li>Call edge transfer: å°†æ•°æ®æµä» call node ä¼ é€åˆ°<strong>è¢«è°ƒç”¨èŠ‚ç‚¹</strong> callee (æ²¿ç€ call edgesï¼Œä¼ é€’<strong>å‚æ•°å€¼</strong>)</li>
<li>Return edge transfer: å°†æ•°æ®æµä» callee ä¸Šçš„ return node ä¼ é€åˆ° return site (æ²¿ç€return edgesï¼Œä¼ é€’<strong>è¿”å›å€¼</strong>)</li>
<li>Node transfer: same as <strong>intraprocedural constant propagation</strong>, except that
<ul>
<li>For call nodes, the transfer function is <strong>identity</strong> function</li>
<li>å¯¹äºæ¯ä¸ªè°ƒç”¨èŠ‚ç‚¹ call node (ä¾‹å¦‚b=addOne(a))ï¼Œä¼šå°†<strong>ç­‰å¼å·¦ä¾§</strong>çš„æ•°å€¼<strong>kill</strong>æ‰ï¼Œç„¶ååœ¨ä¸‹ä¸€æ­¥ä¸­ç”±è¿”å›è¾¹ä¼ é€’å‡½æ•°<strong>é‡æ–°èµ‹å€¼</strong>ã€‚è¿™ä¸ªæ“ä½œå¯ä»¥åœ¨è¿”å›å€¼ä¸åŸå€¼ä¸åŒæ—¶<strong>é˜²æ­¢æ•°æ®å†²çª</strong>ã€‚</li>
</ul>
</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240407190711731.png" alt="image-20240407190711731" style="zoom:50%;" />
<ul>
<li><strong>Example</strong>
<ul>
<li>é»„è‰²èŠ‚ç‚¹è¡¨ç¤º IN æ•°æ®æµï¼Œè“è‰²è¡¨ç¤º OUT æ•°æ®æµ</li>
</ul>
</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240407192922276.png" alt="image-20240407192922276" style="zoom:50%;" />
<ul>
<li>Call-to-return edges allow the analysis to propagate local data-flow (a=6 in this case) on ICFG. Without such edges, we have to propagate local data-flow across other methods, which is very inefficient. å¦‚æœæ²¡æœ‰è¿™æ¡è¾¹ï¼Œå°±éœ€è¦å°†ä»¤ a èµ°è¿‡ä¸€éè°ƒç”¨çš„å‡½æ•°ï¼Œä¼šå¯¼è‡´ä½æ•ˆï¼Œç”šè‡³å‡ºç°é”™è¯¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240407192637921.png" alt="image-20240407192637921" style="zoom:50%;" />
<ul>
<li>å°†<strong>ç­‰å¼å·¦ä¾§</strong>çš„æ•°å€¼<strong>kill</strong>æ‰çš„åŸå› æ˜¯é˜²æ­¢ä¸ç²¾ç¡®ã€‚ä¾‹å¦‚ï¼Œä¸‹å›¾ä¸­ï¼Œå¦‚æœä¸è¿›è¡Œ killï¼Œé‚£ä¹ˆ b = 7 æˆ– 10ï¼Œæœ€ç»ˆå°±æˆä¸º NACï¼Œè¿™æ ·å°±ä¸å¤Ÿç²¾ç¡®ã€‚</li>
</ul>
<img src="\images\7_è¿‡ç¨‹é—´åˆ†æ\image-20240407192850179.png" alt="image-20240407192850179" style="zoom:50%;" />
<h3 id="Interprocedural-Constant-Propagation-In-Summary">Interprocedural Constant Propagation, In Summary</h3>
<ul>
<li>Node transfer
<ul>
<li><strong>Call nodes</strong>: identity</li>
<li><strong>Other nodes</strong>: same as intraprocedural constant propagation</li>
</ul>
</li>
<li>Edge transfer
<ul>
<li><strong>Normal edges</strong>: identity</li>
<li><strong>Call-to-return edges</strong>: kill the value of LHS variable of the call site, propagate values of other local variables</li>
<li><strong>Call edges</strong>: pass argument values</li>
<li><strong>Return edges</strong>: pass return values</li>
</ul>
</li>
</ul>
<h2 id="Focus-Key">Focus Key</h2>
<ul>
<li>How to <strong>build call graph</strong> via <strong>class hierarchy analysis</strong></li>
<li>Concept of interprocedural <strong>control-flow</strong> graph</li>
<li>Concept of interprocedural <strong>data-flow</strong> analysis</li>
<li><strong>Interprocedural constant propagation</strong></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/PA/" rel="tag"># PA</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/04/15/PA_5&6/" rel="prev" title="Program Analysis 5&6ï¼šFoundations of Data Flow Analysis">
                  <i class="fa fa-angle-left"></i> Program Analysis 5&6ï¼šFoundations of Data Flow Analysis
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">ZhangChengWei</span>
  </div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM=" crossorigin="anonymous">



</body>
</html>
