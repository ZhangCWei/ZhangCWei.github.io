<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"zhangcwei.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.19.1","exturl":false,"sidebar":{"position":"left","Sidebar Display (only for Muse | Mist), available values":["hide    expand only when click on the sidebar toggle icon."],"display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Some security issues in Static Analysis.">
<meta property="og:type" content="article">
<meta property="og:title" content="Program Analysis 11：Static Analysis for Security">
<meta property="og:url" content="https://zhangcwei.github.io/2024/04/21/PA_11/index.html">
<meta property="og:site_name" content="Blog of ZhangCW">
<meta property="og:description" content="Some security issues in Static Analysis.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509102153475.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509103607523.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509104241568.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509110546716.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509110144335.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509110527157.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509110742680.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509111548690.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509111609277.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509111745747.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509113707943.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509114023838.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509114338617.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509115146085.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509115048941.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240516100920769.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240516101302882.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240516101312994.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240516103435225.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240516103148574.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240516103246395.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240516103255133.png">
<meta property="og:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240516103917986.png">
<meta property="article:published_time" content="2024-04-21T14:35:37.000Z">
<meta property="article:modified_time" content="2024-10-26T14:09:44.210Z">
<meta property="article:author" content="Chengwei Zhang">
<meta property="article:tag" content="PA">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zhangcwei.github.io/images/11_%E9%9D%99%E6%80%81%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/image-20240509102153475.png">


<link rel="canonical" href="https://zhangcwei.github.io/2024/04/21/PA_11/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://zhangcwei.github.io/2024/04/21/PA_11/","path":"2024/04/21/PA_11/","title":"Program Analysis 11：Static Analysis for Security"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Program Analysis 11：Static Analysis for Security | Blog of ZhangCW</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Blog of ZhangCW</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-text">Static Analysis for Security</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Security-and-Computer-Security"><span class="nav-text">Security and Computer Security</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Information-Flow-Security"><span class="nav-text">Information Flow Security</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Confidentiality-and-Integrity"><span class="nav-text">Confidentiality and Integrity</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Explicit-Flows-and-Covert-Channels"><span class="nav-text">Explicit Flows and Covert Channels</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Taint-Analysis"><span class="nav-text">Taint Analysis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Two-Applications"><span class="nav-text">Two Applications</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Taint-and-Pointer-Analysis-Together"><span class="nav-text">Taint and Pointer Analysis, Together</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Domains-and-Notations"><span class="nav-text">Domains and Notations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Taint-Analysis-Inputs-Outputs"><span class="nav-text">Taint Analysis: Inputs &amp; Outputs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Rules"><span class="nav-text">Rules</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Focus-Key"><span class="nav-text">Focus Key</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Chengwei Zhang"
      src="/images/Chengwei-Zhang.png">
  <p class="site-author-name" itemprop="name">Chengwei Zhang</p>
  <div class="site-description" itemprop="description">An undergraduate student from Sun Yat-sen University, majoring in Software Engineering.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">48</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/ZhangCWei" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ZhangCWei" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zhangcwei.github.io/2024/04/21/PA_11/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/Chengwei-Zhang.png">
      <meta itemprop="name" content="Chengwei Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog of ZhangCW">
      <meta itemprop="description" content="An undergraduate student from Sun Yat-sen University, majoring in Software Engineering.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Program Analysis 11：Static Analysis for Security | Blog of ZhangCW">
      <meta itemprop="description" content="Some security issues in Static Analysis.">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Program Analysis 11：Static Analysis for Security
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-04-21 22:35:37" itemprop="dateCreated datePublished" datetime="2024-04-21T22:35:37+08:00">2024-04-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-10-26 22:09:44" itemprop="dateModified" datetime="2024-10-26T22:09:44+08:00">2024-10-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/PA/" itemprop="url" rel="index"><span itemprop="name">PA</span></a>
        </span>
    </span>

  
</div>

            <div class="post-description">Some security issues in Static Analysis.</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1>Static Analysis for Security</h1>
<h2 id="Security-and-Computer-Security">Security and Computer Security</h2>
<ul>
<li>Achieving some goals in the presence of <strong>adversaries</strong></li>
</ul>
<img src="\images\11_静态安全分析\image-20240509102153475.png" alt="image-20240509102153475" style="zoom:50%;" />
<ul>
<li>在所有计算机攻击中数量最多的几种攻击中，其中两个较常见的攻击都属于信息流问题，分别为<strong>注入攻击(Injection)</strong>、<strong>信息泄露(Sensitive Data Exposure)</strong></li>
</ul>
<h2 id="Information-Flow-Security">Information Flow Security</h2>
<ul>
<li>Information Flow: An Example
<ul>
<li>Prevent <strong>unwanted information flow</strong></li>
<li>Protect information security</li>
</ul>
</li>
</ul>
<img src="\images\11_静态安全分析\image-20240509103607523.png" alt="image-20240509103607523" style="zoom:50%;" />
<ul>
<li><strong>Access Control</strong> vs. <strong>Information Flow Security</strong>
<ul>
<li>Access control (a standard way to protect sensitive data)
<ul>
<li>Checks if the program <strong>has the rights/permissions to access</strong> certain information</li>
<li>Concerns <strong>how information is accessed</strong></li>
<li>控制访问只在<strong>访问点</strong>上做<strong>权限检查</strong>，也就是关注在某点上某个用户是否有权限进行某种操作，但对拿到信息后流向何处的控制无能能力</li>
</ul>
</li>
<li>Information flow security (end-to-end)
<ul>
<li>Tracks how <strong>information flows</strong> through the program to make sure that the program <strong>handles</strong> the information <strong>securely</strong></li>
<li>Concerns <strong>how information is propagated</strong></li>
<li>信息流安全则是对<strong>流动过程</strong>的控制,关注的是某个数据的哪些<strong>传播路径</strong>是合法的，哪些传播路径是非法的。信息流安全也被称为端对端安全。</li>
</ul>
</li>
</ul>
</li>
<li><strong>Information flow</strong>
<ul>
<li>如果一个变量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> 的信息流向了 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>，那么便有信息流 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝑥</mi><mo>→</mo><mi>𝑦</mi></mrow><annotation encoding="application/x-tex">𝑥 \rarr 𝑦</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></li>
</ul>
</li>
</ul>
<img src="\images\11_静态安全分析\image-20240509104241568.png" alt="image-20240509104241568" style="zoom:50%;" />
<ul>
<li>
<p><strong>Information Flow Security</strong></p>
<ul>
<li>Connects information flow to security
<ul>
<li>Classifies program variables into different <strong>security levels</strong>; 给程序中的变量划分等级</li>
<li>Specifies permissible flows between these levels, i.e., information flow policy; 为不同等级之间的变量<strong>制定传播策略</strong></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Security Levels (Classes)</strong></p>
<ul>
<li>
<p>The most basic model is two-level policy, i.e., a variable is classified into one of two security levels:</p>
<ul>
<li>
<p>H, meaning <strong>high security</strong>, secret information</p>
</li>
<li>
<p>L, meaning <strong>low security</strong>, public observable information</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">h = <span class="built_in">getPassword</span>(); 	<span class="comment">// h is high security</span></span><br><span class="line"><span class="built_in">broadcast</span>(l); 		<span class="comment">// l is low security</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>Security levels can be modeled as <strong>lattice*</strong></p>
<ul>
<li>L ≤ H；程序的合法信息传播方向仅有 L 到 L、L 到 H，也可以说是单调传播，那么检查程序中信息流传播<strong>是否满足单调性</strong>，从而判定是否有 H 等级的信息传递到了 L 等级而可能出现安全问题</li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="\images\11_静态安全分析\image-20240509110546716.png" alt="image-20240509110546716" style="zoom:50%;" />
<ul>
<li>More Complicated Security</li>
</ul>
<img src="\images\11_静态安全分析\image-20240509110144335.png" alt="image-20240509110144335" style="zoom: 50%;" />
<ul>
<li><strong>Information Flow Policy</strong>
<ul>
<li>Restricts how information flows between different security levels</li>
<li>Noninterference policy (非干涉策略)
<ul>
<li>Requires the information of high variables <strong>have no effect</strong> on (i.e., should not interfere with) the information of low variables</li>
<li>Intuitively, you should <strong>not be able to conclude</strong> anything about high information by observing low variables</li>
<li>非干涉策略要求：高等级变量的信息<strong>不可以从低等级变量的信息中推导出来</strong>，也说高等级变量的值<strong>不可以对低等级变量的值产生副作用</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="\images\11_静态安全分析\image-20240509110527157.png" alt="image-20240509110527157" style="zoom:50%;" />
<img src="\images\11_静态安全分析\image-20240509110742680.png" alt="image-20240509110742680" style="zoom:50%;" />
<h2 id="Confidentiality-and-Integrity">Confidentiality and Integrity</h2>
<ul>
<li>Confidentiality (保密性)
<ul>
<li>Prevent secret information from being leaked</li>
<li>Information flow security from another perspective</li>
<li><strong>避免私密 (高等级) 信息泄露</strong>到公开 (低等级) 的域，也说是读保护</li>
</ul>
</li>
</ul>
<img src="\images\11_静态安全分析\image-20240509111548690.png" alt="image-20240509111548690" style="zoom:50%;" />
<ul>
<li>
<p>Integrity (完整性)</p>
<ul>
<li>
<p>Prevent untrusted information from corrupting (trusted) critical information</p>
</li>
<li>
<p><strong>避免不可信的 (低等级) 信息污染</strong>可信的 (高等级) 信息，也说是写保护，破坏完整性的常见攻击有：Command injection，SQL 注入，XSS 攻击等。如：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="built_in">readInput</span>()		<span class="comment">// untrusted</span></span><br><span class="line">cmd = <span class="string">&quot;sudo &quot;</span> + x</span><br><span class="line"><span class="built_in">execute</span>(cmd)		<span class="comment">// critical (trusted)</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<img src="\images\11_静态安全分析\image-20240509111609277.png" alt="image-20240509111609277" style="zoom:50%;" />
<ul>
<li>保密性和完整性实际上是从<strong>不同的视角</strong>来认识信息流安全问题的，是一种<strong>双向</strong>的对称关系。这种对偶带来的好处时，可以用一种技术问题解决这两个问题</li>
</ul>
<img src="\images\11_静态安全分析\image-20240509111745747.png" alt="image-20240509111745747" style="zoom:50%;" />
<ul>
<li>Integrity, Broad Definition
<ul>
<li>To ensure the <strong>correctness</strong>, <strong>completeness</strong>, and <strong>consistency</strong> of data
<ul>
<li>correctness 正确性；E.g., for information flow integrity, the (trusted) critical data should not be corrupted by untrusted data</li>
<li>completeness 完整性；E.g., a database system should store all data completely</li>
<li>consistency 一致性；E.g., a file transfer system should ensure that the file contents of both ends (sender and receiver) are identical</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Explicit-Flows-and-Covert-Channels">Explicit Flows and Covert Channels</h2>
<ul>
<li>How Does Information Flow
<ul>
<li>显式流：We have seen how information flows through <strong>direct copying</strong>. This is called <strong>explicit flow</strong>.<br>
<img src="\images\11_静态安全分析\image-20240509113707943.png" alt="image-20240509113707943" style="zoom:50%;" /></li>
<li>隐式流：This kind of information flow is called <strong>implicit flow</strong>, which may arise when the control flow is affected by secret information.
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>u</mi><mi>b</mi><mi>l</mi><mi>i</mi><msub><mi>c</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">public_L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>e</mi><msub><mi>t</mi><mi>H</mi></msub></mrow><annotation encoding="application/x-tex">secret_H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord mathnormal">secre</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 之间没有数据流，但有<strong>信息流</strong> (可以通过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>u</mi><mi>b</mi><mi>l</mi><mi>i</mi><msub><mi>c</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">public_L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 推断出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>e</mi><msub><mi>t</mi><mi>H</mi></msub></mrow><annotation encoding="application/x-tex">secret_H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord mathnormal">secre</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是否大于0)</li>
<li>Any differences in side effects under secret control encode information about the control, which may be publicly observable and leak secret information</li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="\images\11_静态安全分析\image-20240509114023838.png" alt="image-20240509114023838" style="zoom:50%;" />
<ul>
<li>Other kinds of Information flows</li>
</ul>
<img src="\images\11_静态安全分析\image-20240509114338617.png" alt="image-20240509114338617" style="zoom:50%;" />
<ul>
<li>Covert/Hidden Channels
<ul>
<li>信道(channels)是计算机系统中传递信息、发送信息的机制。若该机制本身不是用来传递信息流的，但它仍把信息传递出去了，就称它为<strong>隐藏信道</strong>(Covert Channels)<br>
<img src="\images\11_静态安全分析\image-20240509115146085.png" alt="image-20240509115146085" style="zoom:50%;" /></li>
<li>相比于显式信息流，隐藏信道难以寻找，但同时隐藏信道携带的信息也较少，泄漏的信息有限，所以我们一般聚焦于显式流。如下图，左侧泄漏32位信息，右侧泄漏1bit信息。</li>
</ul>
</li>
</ul>
<img src="\images\11_静态安全分析\image-20240509115048941.png" alt="image-20240509115048941" style="zoom:50%;" />
<h2 id="Taint-Analysis">Taint Analysis</h2>
<ul>
<li>Taint analysis is the most common information flow analysis. It classifies program data into two kinds:
<ul>
<li>Data of interest, some kinds of labels are associated with the data, called <strong>tainted data</strong> (需要关注的数据，打上污点)</li>
<li>Other data, called <strong>untainted data</strong> (不关注的数据)</li>
</ul>
</li>
<li>Sources of tainted data is called sources. In practice, tainted data usually come from the return values of some methods (regarded as <strong>sources</strong>).
<ul>
<li>污点数据 tainted data 的来源，通常来自方法/API的返回值</li>
</ul>
</li>
<li>Taint analysis tracks how tainted data flow through the program and observes if they can flow to locations of interest (called <strong>sinks</strong>). In practice, sinks are usually some <strong>sensitive methods</strong>.
<ul>
<li>通常是某些敏感方法，检查 tainted data 是否作为<strong>参数</strong>传入了这些敏感方法</li>
</ul>
</li>
</ul>
<img src="\images\11_静态安全分析\image-20240516100920769.png" alt="image-20240516100920769" style="zoom:50%;" />
<h3 id="Two-Applications">Two Applications</h3>
<ul>
<li><strong>Confidentiality (保密性)</strong>
<ul>
<li>Source: source of <strong>secret</strong> data</li>
<li>Sink: <strong>leakage</strong></li>
<li>Information leaks</li>
</ul>
</li>
</ul>
<img src="\images\11_静态安全分析\image-20240516101302882.png" alt="image-20240516101302882" style="zoom:50%;" />
<ul>
<li><strong>Integrity (完整性)</strong>
<ul>
<li>Source: source of <strong>untrusted</strong> data</li>
<li>Sink: <strong>critical computation</strong></li>
<li>Injection errors</li>
</ul>
</li>
</ul>
<img src="\images\11_静态安全分析\image-20240516101312994.png" alt="image-20240516101312994" style="zoom:50%;" />
<ul>
<li>Taint analysis can detect <strong>both</strong> unwanted information flows</li>
</ul>
<h3 id="Taint-and-Pointer-Analysis-Together">Taint and Pointer Analysis, Together</h3>
<ul>
<li>The essence of taint analysis/pointer analysis is to <strong>track how tainted data/abstract objects flow through the program</strong>
<ul>
<li>可以把<strong>污点数据</strong> tainted data 看作<strong>对象</strong> object</li>
<li>可以把 <strong>sources</strong> 看作 <strong>allocation sites</strong></li>
<li>借助<strong>指针分析</strong>传播污点数据</li>
</ul>
</li>
</ul>
<h3 id="Domains-and-Notations">Domains and Notations</h3>
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">域</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Variables</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>∈</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">x,y \in V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:center">Fields</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo separator="true">,</mo><mi>g</mi><mo>∈</mo><mi>F</mi></mrow><annotation encoding="application/x-tex">f,g \in F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:center">Objects</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>o</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>o</mi><mi>j</mi></msub><mo>∈</mo><mi>O</mi></mrow><annotation encoding="application/x-tex">o_i,o_j \in O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8252em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:center">Tainted data</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>t</mi><mi>j</mi></msub><mo>∈</mo><mi>T</mi><mo>⊂</mo><mi>O</mi></mrow><annotation encoding="application/x-tex">t_i,t_j \in T ⊂ O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:center">Instance fields</td>
<td style="text-align:center">$o_i.f,o_j.g \in O×F $</td>
</tr>
<tr>
<td style="text-align:center">Pointers</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Pointer</mtext><mo>=</mo><mi>V</mi><mo>∪</mo><mo stretchy="false">(</mo><mi>O</mi><mo>×</mo><mi>F</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Pointer} = V \cup (O×F)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">Pointer</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mclose">)</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:center">Points-to relations</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>t</mi><mo>:</mo><mtext> Pointer</mtext><mo>→</mo><mi>P</mi><mo stretchy="false">(</mo><mi>O</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">pt:~\text{Pointer}→P(O)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">pt</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace nobreak"> </span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">Pointer</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mclose">)</span></span></span></span></td>
</tr>
</tbody>
</table>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> denotes the tainted data from from call site <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>O</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(O)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mclose">)</span></span></span></span> denotes the powerset of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>t</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">pt(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">pt</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span> denotes the points-to set of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></li>
</ul>
<img src="\images\11_静态安全分析\image-20240516103435225.png" alt="image-20240516103435225" style="zoom:50%;" />
<h3 id="Taint-Analysis-Inputs-Outputs">Taint Analysis: Inputs &amp; Outputs</h3>
<ul>
<li>Inputs
<ul>
<li><strong>Sources</strong>: a set of <strong>source methods</strong> (the calls to these methods return tainted data) 我们需要关注由 source 方法产生的污点数据</li>
<li><strong>Sinks</strong>: a set of <strong>sink methods</strong> with <strong>sensitive arguments</strong> (that tainted data flow to the arguments of these methods violates security polices) 我们需要关注污点数据是否会流到 sink 方法中</li>
</ul>
</li>
<li>Outputs
<ul>
<li><strong>TaintFlows</strong>: a set of <strong>tuples</strong> of source and sink calls
<ul>
<li>&lt;污点数据，sink方法&gt;，E.g., <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mi>k</mi><mo>&gt;</mo><mo>∈</mo><mi>T</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>F</mi><mi>l</mi><mi>o</mi><mi>w</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">&lt;i,j,k&gt; ∈ TaintFlows</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal">ain</span><span class="mord mathnormal" style="margin-right:0.01968em;">tFl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">s</span></span></span></span> denotes that the tainted data from <strong>call site</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝑖</mi></mrow><annotation encoding="application/x-tex">𝑖</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> (which calls a source method) may flow to the <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>-th argument</strong> of <strong>call site</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝑗</mi></mrow><annotation encoding="application/x-tex">𝑗</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> (which calls a sink method)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Rules">Rules</h3>
<img src="\images\11_静态安全分析\image-20240516103148574.png" alt="image-20240516103148574" style="zoom:50%;" />
<ul>
<li>Handles sources (generates tainted data)
<ul>
<li>若目标方法为 source，则生成污点数据 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">t_l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，放入 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> 的指针域</li>
</ul>
</li>
</ul>
<img src="\images\11_静态安全分析\image-20240516103246395.png" alt="image-20240516103246395" style="zoom:50%;" />
<ul>
<li>Handles sinks (generates taint flow information)
<ul>
<li>判断目标方法是否为 sink 方法，并确认是否有污点数据作为<strong>参数</strong>流入</li>
</ul>
</li>
</ul>
<img src="\images\11_静态安全分析\image-20240516103255133.png" alt="image-20240516103255133" style="zoom:50%;" />
<ul>
<li><strong>Example</strong>
<ul>
<li>如下图所示，Source 中只有 1 个方法 getPassword()，调用该方法的返回值是 tainted data；Sinks 中只有 1 个方法 log(String) 与其敏感参数 0 的对</li>
<li>从第 1 行开始指针分析；</li>
<li>第 3 行调用了 Source 中的方法，因此 pw 的 Object 中含有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">t_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>；</li>
<li>第 5 行进行 Store，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">t_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 随之传递；</li>
<li>第 6 行进行 Load，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">t_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 传递至 s；</li>
<li>第 7 行调用 Sinks 中方法，且有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>→</mo><mi>𝑚</mi><mo>∈</mo><mi>C</mi><mi>G</mi></mrow><annotation encoding="application/x-tex">l→𝑚∈CG</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">CG</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>m</mi><mo separator="true">,</mo><mi>i</mi><mo>&gt;</mo><mo>∈</mo><mi>S</mi><mi>i</mi><mi>n</mi><mi>k</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">&lt;m, i&gt; \in Sinks</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.03148em;">ink</span><span class="mord mathnormal">s</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>j</mi></msub><mo>∈</mo><mi>p</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">t_j \in pt(a_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">pt</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，所以将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>j</mi><mo separator="true">,</mo><mi>l</mi><mo separator="true">,</mo><mi>i</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;j,l,i&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span> 加入 TaintFlows 中，最终结果为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mo>&lt;</mo><mn>3</mn><mo separator="true">,</mo><mn>7</mn><mo separator="true">,</mo><mn>0</mn><mo>&gt;</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{&lt;3,7,0&gt;\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mclose">}</span></span></span></span></li>
</ul>
</li>
</ul>
<img src="\images\11_静态安全分析\image-20240516103917986.png" alt="image-20240516103917986" style="zoom:50%;" />
<h2 id="Focus-Key">Focus Key</h2>
<ul>
<li>Concept of <strong>information flow security</strong></li>
<li><strong>Confidentiality</strong> and <strong>integrity</strong></li>
<li><strong>Explicit flows</strong> and <strong>covert channels</strong></li>
<li>Use <strong>taint analysis</strong> to detect unwanted information flow</li>
</ul>
<p>​</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/PA/" rel="tag"># PA</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/04/20/PA_10/" rel="prev" title="Program Analysis 10：Context Sensitivity in Pointer Analysis">
                  <i class="fa fa-angle-left"></i> Program Analysis 10：Context Sensitivity in Pointer Analysis
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/04/23/PA_12/" rel="next" title="Program Analysis 12：Datalog-Based Program Analysis">
                  Program Analysis 12：Datalog-Based Program Analysis <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Chengwei Zhang</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM=" crossorigin="anonymous">



</body>
</html>
